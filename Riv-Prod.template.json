{
    "Resources": {
        "SharedStorageMetadataFaceTable609BE09F": {
            "Type": "AWS::DynamoDB::Table",
            "Properties": {
                "KeySchema": [
                    {
                        "AttributeName": "PartitionKey",
                        "KeyType": "HASH"
                    },
                    {
                        "AttributeName": "SortKey",
                        "KeyType": "RANGE"
                    }
                ],
                "AttributeDefinitions": [
                    {
                        "AttributeName": "PartitionKey",
                        "AttributeType": "S"
                    },
                    {
                        "AttributeName": "SortKey",
                        "AttributeType": "S"
                    }
                ],
                "BillingMode": "PAY_PER_REQUEST",
                "PointInTimeRecoverySpecification": {
                    "PointInTimeRecoveryEnabled": true
                }
            },
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/SharedStorage/Metadata/FaceTable/Resource"
            }
        },
        "SharedStorageImagesImageBucket7DE5900F": {
            "Type": "AWS::S3::Bucket",
            "UpdateReplacePolicy": "Retain",
            "DeletionPolicy": "Retain",
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/SharedStorage/Images/ImageBucket/Resource"
            }
        },
        "UserPortalFunctionsCompareFacesRoleCDFF36AC": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "lambda.amazonaws.com"
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "Description": "RivUserPortalCompareFaces for the CompareFaces component.",
                "ManagedPolicyArns": [
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AWSXRayDaemonWriteAccess"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AmazonRekognitionFullAccess"
                            ]
                        ]
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/CompareFaces/Role/Resource"
            }
        },
        "UserPortalFunctionsCompareFacesRoleDefaultPolicy0498D433": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": "ssm:GetParameter*",
                            "Effect": "Allow",
                            "Resource": {
                                "Fn::Join": [
                                    "",
                                    [
                                        "arn:aws:ssm:",
                                        {
                                            "Ref": "AWS::Region"
                                        },
                                        ":",
                                        {
                                            "Ref": "AWS::AccountId"
                                        },
                                        ":parameter/riv/Riv-Prod/rekognition/*"
                                    ]
                                ]
                            }
                        },
                        {
                            "Action": [
                                "dynamodb:BatchGetItem",
                                "dynamodb:GetRecords",
                                "dynamodb:GetShardIterator",
                                "dynamodb:Query",
                                "dynamodb:GetItem",
                                "dynamodb:Scan",
                                "dynamodb:ConditionCheckItem",
                                "dynamodb:DescribeTable"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "SharedStorageMetadataFaceTable609BE09F",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Ref": "AWS::NoValue"
                                }
                            ]
                        },
                        {
                            "Action": [
                                "s3:GetObject*",
                                "s3:GetBucket*",
                                "s3:List*"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "SharedStorageImagesImageBucket7DE5900F",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "SharedStorageImagesImageBucket7DE5900F",
                                                    "Arn"
                                                ]
                                            },
                                            "/*"
                                        ]
                                    ]
                                }
                            ]
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "UserPortalFunctionsCompareFacesRoleDefaultPolicy0498D433",
                "Roles": [
                    {
                        "Ref": "UserPortalFunctionsCompareFacesRoleCDFF36AC"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/CompareFaces/Role/DefaultPolicy/Resource"
            }
        },
        "UserPortalFunctionsCompareFacesLambdaFunction0ED2F588": {
            "Type": "AWS::Lambda::Function",
            "Properties": {
                "Code": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/7c456d69f0afd0270a4c78c155787d61c8b351fbcfa360f23df49d677b136d88.zip"
                },
                "Role": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsCompareFacesRoleCDFF36AC",
                        "Arn"
                    ]
                },
                "Description": "Python container lambda function for CompareFaces",
                "Environment": {
                    "Variables": {
                        "REGION": {
                            "Ref": "AWS::Region"
                        },
                        "RIV_STACK_NAME": {
                            "Ref": "AWS::StackName"
                        },
                        "FACE_TABLE_NAME": {
                            "Ref": "SharedStorageMetadataFaceTable609BE09F"
                        },
                        "IMAGE_BUCKET_NAME": {
                            "Ref": "SharedStorageImagesImageBucket7DE5900F"
                        }
                    }
                },
                "Handler": "handler.function_main",
                "Layers": [
                    {
                        "Ref": "UserPortalFunctionsCompareFacesSharedDepsBB15B7E8"
                    }
                ],
                "MemorySize": 512,
                "Runtime": "python3.9",
                "Timeout": 30,
                "TracingConfig": {
                    "Mode": "Active"
                }
            },
            "DependsOn": [
                "UserPortalFunctionsCompareFacesRoleDefaultPolicy0498D433",
                "UserPortalFunctionsCompareFacesRoleCDFF36AC"
            ],
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/CompareFaces/LambdaFunction/Resource",
                "aws:asset:path": "asset.7c456d69f0afd0270a4c78c155787d61c8b351fbcfa360f23df49d677b136d88",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Code"
            }
        },
        "UserPortalFunctionsCompareFacesSharedDepsBB15B7E8": {
            "Type": "AWS::Lambda::LayerVersion",
            "Properties": {
                "Content": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210.zip"
                },
                "CompatibleRuntimes": [
                    "python3.9"
                ],
                "Description": "Shared dependencies"
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/CompareFaces/SharedDeps/Resource",
                "aws:asset:path": "asset.d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Content"
            }
        },
        "UserPortalFunctionsDetectFacesRole80C76BF2": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "lambda.amazonaws.com"
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "Description": "RivUserPortalDetectFaces for the DetectFaces component.",
                "ManagedPolicyArns": [
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AWSXRayDaemonWriteAccess"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AmazonRekognitionFullAccess"
                            ]
                        ]
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/DetectFaces/Role/Resource"
            }
        },
        "UserPortalFunctionsDetectFacesRoleDefaultPolicyFD1CA8F3": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": "ssm:GetParameter*",
                            "Effect": "Allow",
                            "Resource": {
                                "Fn::Join": [
                                    "",
                                    [
                                        "arn:aws:ssm:",
                                        {
                                            "Ref": "AWS::Region"
                                        },
                                        ":",
                                        {
                                            "Ref": "AWS::AccountId"
                                        },
                                        ":parameter/riv/Riv-Prod/rekognition/*"
                                    ]
                                ]
                            }
                        },
                        {
                            "Action": [
                                "s3:GetObject*",
                                "s3:GetBucket*",
                                "s3:List*"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "SharedStorageImagesImageBucket7DE5900F",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "SharedStorageImagesImageBucket7DE5900F",
                                                    "Arn"
                                                ]
                                            },
                                            "/*"
                                        ]
                                    ]
                                }
                            ]
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "UserPortalFunctionsDetectFacesRoleDefaultPolicyFD1CA8F3",
                "Roles": [
                    {
                        "Ref": "UserPortalFunctionsDetectFacesRole80C76BF2"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/DetectFaces/Role/DefaultPolicy/Resource"
            }
        },
        "UserPortalFunctionsDetectFacesLambdaFunctionC2191E4E": {
            "Type": "AWS::Lambda::Function",
            "Properties": {
                "Code": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/c2f14e2e3a38246d00709042a57d9648432a681c50184a96ed3b3cbc1104e24f.zip"
                },
                "Role": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsDetectFacesRole80C76BF2",
                        "Arn"
                    ]
                },
                "Description": "Python container lambda function for DetectFaces",
                "Environment": {
                    "Variables": {
                        "REGION": {
                            "Ref": "AWS::Region"
                        },
                        "RIV_STACK_NAME": {
                            "Ref": "AWS::StackName"
                        },
                        "FACE_TABLE_NAME": {
                            "Ref": "SharedStorageMetadataFaceTable609BE09F"
                        },
                        "IMAGE_BUCKET_NAME": {
                            "Ref": "SharedStorageImagesImageBucket7DE5900F"
                        }
                    }
                },
                "Handler": "handler.function_main",
                "Layers": [
                    {
                        "Ref": "UserPortalFunctionsDetectFacesSharedDeps049F610A"
                    }
                ],
                "MemorySize": 512,
                "Runtime": "python3.9",
                "Timeout": 30,
                "TracingConfig": {
                    "Mode": "Active"
                }
            },
            "DependsOn": [
                "UserPortalFunctionsDetectFacesRoleDefaultPolicyFD1CA8F3",
                "UserPortalFunctionsDetectFacesRole80C76BF2"
            ],
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/DetectFaces/LambdaFunction/Resource",
                "aws:asset:path": "asset.c2f14e2e3a38246d00709042a57d9648432a681c50184a96ed3b3cbc1104e24f",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Code"
            }
        },
        "UserPortalFunctionsDetectFacesSharedDeps049F610A": {
            "Type": "AWS::Lambda::LayerVersion",
            "Properties": {
                "Content": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210.zip"
                },
                "CompatibleRuntimes": [
                    "python3.9"
                ],
                "Description": "Shared dependencies"
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/DetectFaces/SharedDeps/Resource",
                "aws:asset:path": "asset.d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Content"
            }
        },
        "UserPortalFunctionsSearchFacesRole378D7883": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "lambda.amazonaws.com"
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "Description": "RivUserPortalSearchFacesByImage for the SearchFaces component.",
                "ManagedPolicyArns": [
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AWSXRayDaemonWriteAccess"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AmazonRekognitionFullAccess"
                            ]
                        ]
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/SearchFaces/Role/Resource"
            }
        },
        "UserPortalFunctionsSearchFacesRoleDefaultPolicyF671B579": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": "ssm:GetParameter*",
                            "Effect": "Allow",
                            "Resource": {
                                "Fn::Join": [
                                    "",
                                    [
                                        "arn:aws:ssm:",
                                        {
                                            "Ref": "AWS::Region"
                                        },
                                        ":",
                                        {
                                            "Ref": "AWS::AccountId"
                                        },
                                        ":parameter/riv/Riv-Prod/rekognition/*"
                                    ]
                                ]
                            }
                        },
                        {
                            "Action": [
                                "s3:GetObject*",
                                "s3:GetBucket*",
                                "s3:List*"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "SharedStorageImagesImageBucket7DE5900F",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "SharedStorageImagesImageBucket7DE5900F",
                                                    "Arn"
                                                ]
                                            },
                                            "/*"
                                        ]
                                    ]
                                }
                            ]
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "UserPortalFunctionsSearchFacesRoleDefaultPolicyF671B579",
                "Roles": [
                    {
                        "Ref": "UserPortalFunctionsSearchFacesRole378D7883"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/SearchFaces/Role/DefaultPolicy/Resource"
            }
        },
        "UserPortalFunctionsSearchFacesLambdaFunction780C379C": {
            "Type": "AWS::Lambda::Function",
            "Properties": {
                "Code": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/a584246ab42c17bb5e6a144cf25ac56f97fd272761fd2deb319498065a9059b1.zip"
                },
                "Role": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsSearchFacesRole378D7883",
                        "Arn"
                    ]
                },
                "Description": "Python container lambda function for SearchFaces",
                "Environment": {
                    "Variables": {
                        "REGION": {
                            "Ref": "AWS::Region"
                        },
                        "RIV_STACK_NAME": {
                            "Ref": "AWS::StackName"
                        },
                        "FACE_TABLE_NAME": {
                            "Ref": "SharedStorageMetadataFaceTable609BE09F"
                        },
                        "IMAGE_BUCKET_NAME": {
                            "Ref": "SharedStorageImagesImageBucket7DE5900F"
                        }
                    }
                },
                "Handler": "handler.function_main",
                "Layers": [
                    {
                        "Ref": "UserPortalFunctionsSearchFacesSharedDepsF6661C73"
                    }
                ],
                "MemorySize": 512,
                "Runtime": "python3.9",
                "Timeout": 30,
                "TracingConfig": {
                    "Mode": "Active"
                }
            },
            "DependsOn": [
                "UserPortalFunctionsSearchFacesRoleDefaultPolicyF671B579",
                "UserPortalFunctionsSearchFacesRole378D7883"
            ],
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/SearchFaces/LambdaFunction/Resource",
                "aws:asset:path": "asset.a584246ab42c17bb5e6a144cf25ac56f97fd272761fd2deb319498065a9059b1",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Code"
            }
        },
        "UserPortalFunctionsSearchFacesSharedDepsF6661C73": {
            "Type": "AWS::Lambda::LayerVersion",
            "Properties": {
                "Content": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210.zip"
                },
                "CompatibleRuntimes": [
                    "python3.9"
                ],
                "Description": "Shared dependencies"
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/SearchFaces/SharedDeps/Resource",
                "aws:asset:path": "asset.d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Content"
            }
        },
        "UserPortalFunctionsExtractIdCardRole4955A0C5": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "lambda.amazonaws.com"
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "Description": "RivUserPortalExtractIdCard for the Extract-IdCard component.",
                "ManagedPolicyArns": [
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AWSXRayDaemonWriteAccess"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AmazonRekognitionFullAccess"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AmazonTextractFullAccess"
                            ]
                        ]
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/ExtractIdCard/Role/Resource"
            }
        },
        "UserPortalFunctionsExtractIdCardRoleDefaultPolicy8AD0B36A": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": "ssm:GetParameter*",
                            "Effect": "Allow",
                            "Resource": {
                                "Fn::Join": [
                                    "",
                                    [
                                        "arn:aws:ssm:",
                                        {
                                            "Ref": "AWS::Region"
                                        },
                                        ":",
                                        {
                                            "Ref": "AWS::AccountId"
                                        },
                                        ":parameter/riv/Riv-Prod/rekognition/*"
                                    ]
                                ]
                            }
                        },
                        {
                            "Action": [
                                "s3:GetObject*",
                                "s3:GetBucket*",
                                "s3:List*",
                                "s3:DeleteObject*",
                                "s3:PutObject",
                                "s3:PutObjectLegalHold",
                                "s3:PutObjectRetention",
                                "s3:PutObjectTagging",
                                "s3:PutObjectVersionTagging",
                                "s3:Abort*"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "SharedStorageImagesImageBucket7DE5900F",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "SharedStorageImagesImageBucket7DE5900F",
                                                    "Arn"
                                                ]
                                            },
                                            "/*"
                                        ]
                                    ]
                                }
                            ]
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "UserPortalFunctionsExtractIdCardRoleDefaultPolicy8AD0B36A",
                "Roles": [
                    {
                        "Ref": "UserPortalFunctionsExtractIdCardRole4955A0C5"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/ExtractIdCard/Role/DefaultPolicy/Resource"
            }
        },
        "UserPortalFunctionsExtractIdCardLambdaFunctionB2515571": {
            "Type": "AWS::Lambda::Function",
            "Properties": {
                "Code": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/621612182b7ba9346ec010af07163205250a6878990504135575580d386f725d.zip"
                },
                "Role": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsExtractIdCardRole4955A0C5",
                        "Arn"
                    ]
                },
                "Description": "Python container lambda function for Extract-IdCard",
                "Environment": {
                    "Variables": {
                        "REGION": {
                            "Ref": "AWS::Region"
                        },
                        "RIV_STACK_NAME": {
                            "Ref": "AWS::StackName"
                        },
                        "FACE_TABLE_NAME": {
                            "Ref": "SharedStorageMetadataFaceTable609BE09F"
                        },
                        "IMAGE_BUCKET_NAME": {
                            "Ref": "SharedStorageImagesImageBucket7DE5900F"
                        }
                    }
                },
                "Handler": "handler.function_main",
                "Layers": [
                    {
                        "Ref": "UserPortalFunctionsExtractIdCardSharedDeps8700438E"
                    }
                ],
                "MemorySize": 512,
                "Runtime": "python3.9",
                "Timeout": 30,
                "TracingConfig": {
                    "Mode": "Active"
                }
            },
            "DependsOn": [
                "UserPortalFunctionsExtractIdCardRoleDefaultPolicy8AD0B36A",
                "UserPortalFunctionsExtractIdCardRole4955A0C5"
            ],
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/ExtractIdCard/LambdaFunction/Resource",
                "aws:asset:path": "asset.621612182b7ba9346ec010af07163205250a6878990504135575580d386f725d",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Code"
            }
        },
        "UserPortalFunctionsExtractIdCardSharedDeps8700438E": {
            "Type": "AWS::Lambda::LayerVersion",
            "Properties": {
                "Content": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210.zip"
                },
                "CompatibleRuntimes": [
                    "python3.9"
                ],
                "Description": "Shared dependencies"
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/ExtractIdCard/SharedDeps/Resource",
                "aws:asset:path": "asset.d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Content"
            }
        },
        "UserPortalFunctionsCompareFacesWithIDCardRole07FEC06D": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "lambda.amazonaws.com"
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "Description": "RivUserPortalCompareFacesWithIDCard for the CompareFacesWithIDCard component.",
                "ManagedPolicyArns": [
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AWSXRayDaemonWriteAccess"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AmazonRekognitionFullAccess"
                            ]
                        ]
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/CompareFacesWithIDCard/Role/Resource"
            }
        },
        "UserPortalFunctionsCompareFacesWithIDCardRoleDefaultPolicy61F09AF1": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": "ssm:GetParameter*",
                            "Effect": "Allow",
                            "Resource": {
                                "Fn::Join": [
                                    "",
                                    [
                                        "arn:aws:ssm:",
                                        {
                                            "Ref": "AWS::Region"
                                        },
                                        ":",
                                        {
                                            "Ref": "AWS::AccountId"
                                        },
                                        ":parameter/riv/Riv-Prod/rekognition/*"
                                    ]
                                ]
                            }
                        },
                        {
                            "Action": [
                                "s3:GetObject*",
                                "s3:GetBucket*",
                                "s3:List*"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "SharedStorageImagesImageBucket7DE5900F",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "SharedStorageImagesImageBucket7DE5900F",
                                                    "Arn"
                                                ]
                                            },
                                            "/*"
                                        ]
                                    ]
                                }
                            ]
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "UserPortalFunctionsCompareFacesWithIDCardRoleDefaultPolicy61F09AF1",
                "Roles": [
                    {
                        "Ref": "UserPortalFunctionsCompareFacesWithIDCardRole07FEC06D"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/CompareFacesWithIDCard/Role/DefaultPolicy/Resource"
            }
        },
        "UserPortalFunctionsCompareFacesWithIDCardLambdaFunction99427197": {
            "Type": "AWS::Lambda::Function",
            "Properties": {
                "Code": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/3fe4ad3fa6a7927a178acf8d33f19fb4a153f2f11d000151163e84a7091628bb.zip"
                },
                "Role": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsCompareFacesWithIDCardRole07FEC06D",
                        "Arn"
                    ]
                },
                "Description": "Python container lambda function for CompareFacesWithIDCard",
                "Environment": {
                    "Variables": {
                        "REGION": {
                            "Ref": "AWS::Region"
                        },
                        "RIV_STACK_NAME": {
                            "Ref": "AWS::StackName"
                        },
                        "FACE_TABLE_NAME": {
                            "Ref": "SharedStorageMetadataFaceTable609BE09F"
                        },
                        "IMAGE_BUCKET_NAME": {
                            "Ref": "SharedStorageImagesImageBucket7DE5900F"
                        }
                    }
                },
                "Handler": "handler.function_main",
                "Layers": [
                    {
                        "Ref": "UserPortalFunctionsCompareFacesWithIDCardSharedDeps54674489"
                    }
                ],
                "MemorySize": 512,
                "Runtime": "python3.9",
                "Timeout": 30,
                "TracingConfig": {
                    "Mode": "Active"
                }
            },
            "DependsOn": [
                "UserPortalFunctionsCompareFacesWithIDCardRoleDefaultPolicy61F09AF1",
                "UserPortalFunctionsCompareFacesWithIDCardRole07FEC06D"
            ],
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/CompareFacesWithIDCard/LambdaFunction/Resource",
                "aws:asset:path": "asset.3fe4ad3fa6a7927a178acf8d33f19fb4a153f2f11d000151163e84a7091628bb",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Code"
            }
        },
        "UserPortalFunctionsCompareFacesWithIDCardSharedDeps54674489": {
            "Type": "AWS::Lambda::LayerVersion",
            "Properties": {
                "Content": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210.zip"
                },
                "CompatibleRuntimes": [
                    "python3.9"
                ],
                "Description": "Shared dependencies"
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/CompareFacesWithIDCard/SharedDeps/Resource",
                "aws:asset:path": "asset.d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Content"
            }
        },
        "UserPortalFunctionsStartLivenessSesstionRole59B60DAB": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "lambda.amazonaws.com"
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "Description": "RivUserPortalStartLivenessSesstion for the StartLivenessSesstion component.",
                "ManagedPolicyArns": [
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AWSXRayDaemonWriteAccess"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AmazonRekognitionFullAccess"
                            ]
                        ]
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/StartLivenessSesstion/Role/Resource"
            }
        },
        "UserPortalFunctionsStartLivenessSesstionRoleDefaultPolicyE94046D4": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": "ssm:GetParameter*",
                            "Effect": "Allow",
                            "Resource": {
                                "Fn::Join": [
                                    "",
                                    [
                                        "arn:aws:ssm:",
                                        {
                                            "Ref": "AWS::Region"
                                        },
                                        ":",
                                        {
                                            "Ref": "AWS::AccountId"
                                        },
                                        ":parameter/riv/Riv-Prod/rekognition/*"
                                    ]
                                ]
                            }
                        },
                        {
                            "Action": [
                                "s3:PutObject",
                                "s3:PutObjectLegalHold",
                                "s3:PutObjectRetention",
                                "s3:PutObjectTagging",
                                "s3:PutObjectVersionTagging",
                                "s3:Abort*"
                            ],
                            "Effect": "Allow",
                            "Resource": {
                                "Fn::Join": [
                                    "",
                                    [
                                        {
                                            "Fn::GetAtt": [
                                                "SharedStorageImagesImageBucket7DE5900F",
                                                "Arn"
                                            ]
                                        },
                                        "/*"
                                    ]
                                ]
                            }
                        },
                        {
                            "Action": [
                                "s3:GetObject*",
                                "s3:GetBucket*",
                                "s3:List*"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "SharedStorageImagesImageBucket7DE5900F",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "SharedStorageImagesImageBucket7DE5900F",
                                                    "Arn"
                                                ]
                                            },
                                            "/*"
                                        ]
                                    ]
                                }
                            ]
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "UserPortalFunctionsStartLivenessSesstionRoleDefaultPolicyE94046D4",
                "Roles": [
                    {
                        "Ref": "UserPortalFunctionsStartLivenessSesstionRole59B60DAB"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/StartLivenessSesstion/Role/DefaultPolicy/Resource"
            }
        },
        "UserPortalFunctionsStartLivenessSesstionLambdaFunctionAF5D813E": {
            "Type": "AWS::Lambda::Function",
            "Properties": {
                "Code": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/45ece8615e3d54d751c8a524c0d45e5a5117fa733bd450d5c1a0e46e8825d9af.zip"
                },
                "Role": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsStartLivenessSesstionRole59B60DAB",
                        "Arn"
                    ]
                },
                "Description": "Python container lambda function for StartLivenessSesstion",
                "Environment": {
                    "Variables": {
                        "REGION": {
                            "Ref": "AWS::Region"
                        },
                        "RIV_STACK_NAME": {
                            "Ref": "AWS::StackName"
                        },
                        "FACE_TABLE_NAME": {
                            "Ref": "SharedStorageMetadataFaceTable609BE09F"
                        },
                        "IMAGE_BUCKET_NAME": {
                            "Ref": "SharedStorageImagesImageBucket7DE5900F"
                        }
                    }
                },
                "Handler": "handler.function_main",
                "Layers": [
                    {
                        "Ref": "UserPortalFunctionsStartLivenessSesstionSharedDepsC1C2C219"
                    }
                ],
                "MemorySize": 512,
                "Runtime": "python3.9",
                "Timeout": 30,
                "TracingConfig": {
                    "Mode": "Active"
                }
            },
            "DependsOn": [
                "UserPortalFunctionsStartLivenessSesstionRoleDefaultPolicyE94046D4",
                "UserPortalFunctionsStartLivenessSesstionRole59B60DAB"
            ],
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/StartLivenessSesstion/LambdaFunction/Resource",
                "aws:asset:path": "asset.45ece8615e3d54d751c8a524c0d45e5a5117fa733bd450d5c1a0e46e8825d9af",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Code"
            }
        },
        "UserPortalFunctionsStartLivenessSesstionSharedDepsC1C2C219": {
            "Type": "AWS::Lambda::LayerVersion",
            "Properties": {
                "Content": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210.zip"
                },
                "CompatibleRuntimes": [
                    "python3.9"
                ],
                "Description": "Shared dependencies"
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/StartLivenessSesstion/SharedDeps/Resource",
                "aws:asset:path": "asset.d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Content"
            }
        },
        "UserPortalFunctionsResetUserRole2A662A9B": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "lambda.amazonaws.com"
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "Description": "RivUserPortalResetUser for the ResetUser component.",
                "ManagedPolicyArns": [
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AWSXRayDaemonWriteAccess"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AmazonRekognitionFullAccess"
                            ]
                        ]
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/ResetUser/Role/Resource"
            }
        },
        "UserPortalFunctionsResetUserRoleDefaultPolicyA86D4936": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": "ssm:GetParameter*",
                            "Effect": "Allow",
                            "Resource": {
                                "Fn::Join": [
                                    "",
                                    [
                                        "arn:aws:ssm:",
                                        {
                                            "Ref": "AWS::Region"
                                        },
                                        ":",
                                        {
                                            "Ref": "AWS::AccountId"
                                        },
                                        ":parameter/riv/Riv-Prod/rekognition/*"
                                    ]
                                ]
                            }
                        },
                        {
                            "Action": [
                                "dynamodb:BatchGetItem",
                                "dynamodb:GetRecords",
                                "dynamodb:GetShardIterator",
                                "dynamodb:Query",
                                "dynamodb:GetItem",
                                "dynamodb:Scan",
                                "dynamodb:ConditionCheckItem",
                                "dynamodb:BatchWriteItem",
                                "dynamodb:PutItem",
                                "dynamodb:UpdateItem",
                                "dynamodb:DeleteItem",
                                "dynamodb:DescribeTable"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "SharedStorageMetadataFaceTable609BE09F",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Ref": "AWS::NoValue"
                                }
                            ]
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "UserPortalFunctionsResetUserRoleDefaultPolicyA86D4936",
                "Roles": [
                    {
                        "Ref": "UserPortalFunctionsResetUserRole2A662A9B"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/ResetUser/Role/DefaultPolicy/Resource"
            }
        },
        "UserPortalFunctionsResetUserLambdaFunction42DCB7C0": {
            "Type": "AWS::Lambda::Function",
            "Properties": {
                "Code": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/e3185af244da6c97f40be2606b79e2f0f7d8cc87c31bd88776d6741061d34bca.zip"
                },
                "Role": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsResetUserRole2A662A9B",
                        "Arn"
                    ]
                },
                "Description": "Python container lambda function for ResetUser",
                "Environment": {
                    "Variables": {
                        "REGION": {
                            "Ref": "AWS::Region"
                        },
                        "RIV_STACK_NAME": {
                            "Ref": "AWS::StackName"
                        },
                        "FACE_TABLE_NAME": {
                            "Ref": "SharedStorageMetadataFaceTable609BE09F"
                        },
                        "IMAGE_BUCKET_NAME": {
                            "Ref": "SharedStorageImagesImageBucket7DE5900F"
                        }
                    }
                },
                "Handler": "handler.function_main",
                "Layers": [
                    {
                        "Ref": "UserPortalFunctionsResetUserSharedDeps41F386E6"
                    }
                ],
                "MemorySize": 512,
                "Runtime": "python3.9",
                "Timeout": 30,
                "TracingConfig": {
                    "Mode": "Active"
                }
            },
            "DependsOn": [
                "UserPortalFunctionsResetUserRoleDefaultPolicyA86D4936",
                "UserPortalFunctionsResetUserRole2A662A9B"
            ],
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/ResetUser/LambdaFunction/Resource",
                "aws:asset:path": "asset.e3185af244da6c97f40be2606b79e2f0f7d8cc87c31bd88776d6741061d34bca",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Code"
            }
        },
        "UserPortalFunctionsResetUserSharedDeps41F386E6": {
            "Type": "AWS::Lambda::LayerVersion",
            "Properties": {
                "Content": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210.zip"
                },
                "CompatibleRuntimes": [
                    "python3.9"
                ],
                "Description": "Shared dependencies"
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/ResetUser/SharedDeps/Resource",
                "aws:asset:path": "asset.d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Content"
            }
        },
        "UserPortalFunctionsLivenessSesstionResultRoleF162D5E7": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "lambda.amazonaws.com"
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "Description": "RivUserPortalLivenessSesstionResult for the LivenessSesstionResult component.",
                "ManagedPolicyArns": [
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AWSXRayDaemonWriteAccess"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AmazonRekognitionFullAccess"
                            ]
                        ]
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/LivenessSesstionResult/Role/Resource"
            }
        },
        "UserPortalFunctionsLivenessSesstionResultRoleDefaultPolicy9F34E511": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": "ssm:GetParameter*",
                            "Effect": "Allow",
                            "Resource": {
                                "Fn::Join": [
                                    "",
                                    [
                                        "arn:aws:ssm:",
                                        {
                                            "Ref": "AWS::Region"
                                        },
                                        ":",
                                        {
                                            "Ref": "AWS::AccountId"
                                        },
                                        ":parameter/riv/Riv-Prod/rekognition/*"
                                    ]
                                ]
                            }
                        },
                        {
                            "Action": [
                                "s3:PutObject",
                                "s3:PutObjectLegalHold",
                                "s3:PutObjectRetention",
                                "s3:PutObjectTagging",
                                "s3:PutObjectVersionTagging",
                                "s3:Abort*"
                            ],
                            "Effect": "Allow",
                            "Resource": {
                                "Fn::Join": [
                                    "",
                                    [
                                        {
                                            "Fn::GetAtt": [
                                                "SharedStorageImagesImageBucket7DE5900F",
                                                "Arn"
                                            ]
                                        },
                                        "/*"
                                    ]
                                ]
                            }
                        },
                        {
                            "Action": [
                                "s3:GetObject*",
                                "s3:GetBucket*",
                                "s3:List*"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "SharedStorageImagesImageBucket7DE5900F",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "SharedStorageImagesImageBucket7DE5900F",
                                                    "Arn"
                                                ]
                                            },
                                            "/*"
                                        ]
                                    ]
                                }
                            ]
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "UserPortalFunctionsLivenessSesstionResultRoleDefaultPolicy9F34E511",
                "Roles": [
                    {
                        "Ref": "UserPortalFunctionsLivenessSesstionResultRoleF162D5E7"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/LivenessSesstionResult/Role/DefaultPolicy/Resource"
            }
        },
        "UserPortalFunctionsLivenessSesstionResultLambdaFunction45774E6D": {
            "Type": "AWS::Lambda::Function",
            "Properties": {
                "Code": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/1d896b8c017f09534b0bf4caeec2807acfc74e0439b0e032c61ec66d2e4b58b3.zip"
                },
                "Role": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsLivenessSesstionResultRoleF162D5E7",
                        "Arn"
                    ]
                },
                "Description": "Python container lambda function for LivenessSesstionResult",
                "Environment": {
                    "Variables": {
                        "REGION": {
                            "Ref": "AWS::Region"
                        },
                        "RIV_STACK_NAME": {
                            "Ref": "AWS::StackName"
                        },
                        "FACE_TABLE_NAME": {
                            "Ref": "SharedStorageMetadataFaceTable609BE09F"
                        },
                        "IMAGE_BUCKET_NAME": {
                            "Ref": "SharedStorageImagesImageBucket7DE5900F"
                        }
                    }
                },
                "Handler": "handler.function_main",
                "Layers": [
                    {
                        "Ref": "UserPortalFunctionsLivenessSesstionResultSharedDepsEC3AA9BB"
                    }
                ],
                "MemorySize": 512,
                "Runtime": "python3.9",
                "Timeout": 30,
                "TracingConfig": {
                    "Mode": "Active"
                }
            },
            "DependsOn": [
                "UserPortalFunctionsLivenessSesstionResultRoleDefaultPolicy9F34E511",
                "UserPortalFunctionsLivenessSesstionResultRoleF162D5E7"
            ],
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/LivenessSesstionResult/LambdaFunction/Resource",
                "aws:asset:path": "asset.1d896b8c017f09534b0bf4caeec2807acfc74e0439b0e032c61ec66d2e4b58b3",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Code"
            }
        },
        "UserPortalFunctionsLivenessSesstionResultSharedDepsEC3AA9BB": {
            "Type": "AWS::Lambda::LayerVersion",
            "Properties": {
                "Content": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210.zip"
                },
                "CompatibleRuntimes": [
                    "python3.9"
                ],
                "Description": "Shared dependencies"
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/LivenessSesstionResult/SharedDeps/Resource",
                "aws:asset:path": "asset.d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Content"
            }
        },
        "UserPortalFunctionsCheckUserIDRoleF4487A64": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "lambda.amazonaws.com"
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "Description": "RivUserPortalCheckUserID for the CheckUserID component.",
                "ManagedPolicyArns": [
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AWSXRayDaemonWriteAccess"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AmazonRekognitionFullAccess"
                            ]
                        ]
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/CheckUserID/Role/Resource"
            }
        },
        "UserPortalFunctionsCheckUserIDRoleDefaultPolicyED833D84": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": "ssm:GetParameter*",
                            "Effect": "Allow",
                            "Resource": {
                                "Fn::Join": [
                                    "",
                                    [
                                        "arn:aws:ssm:",
                                        {
                                            "Ref": "AWS::Region"
                                        },
                                        ":",
                                        {
                                            "Ref": "AWS::AccountId"
                                        },
                                        ":parameter/riv/Riv-Prod/rekognition/*"
                                    ]
                                ]
                            }
                        },
                        {
                            "Action": [
                                "dynamodb:BatchGetItem",
                                "dynamodb:GetRecords",
                                "dynamodb:GetShardIterator",
                                "dynamodb:Query",
                                "dynamodb:GetItem",
                                "dynamodb:Scan",
                                "dynamodb:ConditionCheckItem",
                                "dynamodb:BatchWriteItem",
                                "dynamodb:PutItem",
                                "dynamodb:UpdateItem",
                                "dynamodb:DeleteItem",
                                "dynamodb:DescribeTable"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "SharedStorageMetadataFaceTable609BE09F",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Ref": "AWS::NoValue"
                                }
                            ]
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "UserPortalFunctionsCheckUserIDRoleDefaultPolicyED833D84",
                "Roles": [
                    {
                        "Ref": "UserPortalFunctionsCheckUserIDRoleF4487A64"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/CheckUserID/Role/DefaultPolicy/Resource"
            }
        },
        "UserPortalFunctionsCheckUserIDLambdaFunction0189D9DC": {
            "Type": "AWS::Lambda::Function",
            "Properties": {
                "Code": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/e86a8a67a1ebcef419f97f57a33e829878155453e603b18d71fad8ab820c8681.zip"
                },
                "Role": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsCheckUserIDRoleF4487A64",
                        "Arn"
                    ]
                },
                "Description": "Python container lambda function for CheckUserID",
                "Environment": {
                    "Variables": {
                        "REGION": {
                            "Ref": "AWS::Region"
                        },
                        "RIV_STACK_NAME": {
                            "Ref": "AWS::StackName"
                        },
                        "FACE_TABLE_NAME": {
                            "Ref": "SharedStorageMetadataFaceTable609BE09F"
                        },
                        "IMAGE_BUCKET_NAME": {
                            "Ref": "SharedStorageImagesImageBucket7DE5900F"
                        }
                    }
                },
                "Handler": "handler.function_main",
                "Layers": [
                    {
                        "Ref": "UserPortalFunctionsCheckUserIDSharedDepsE624140A"
                    }
                ],
                "MemorySize": 512,
                "Runtime": "python3.9",
                "Timeout": 30,
                "TracingConfig": {
                    "Mode": "Active"
                }
            },
            "DependsOn": [
                "UserPortalFunctionsCheckUserIDRoleDefaultPolicyED833D84",
                "UserPortalFunctionsCheckUserIDRoleF4487A64"
            ],
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/CheckUserID/LambdaFunction/Resource",
                "aws:asset:path": "asset.e86a8a67a1ebcef419f97f57a33e829878155453e603b18d71fad8ab820c8681",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Code"
            }
        },
        "UserPortalFunctionsCheckUserIDSharedDepsE624140A": {
            "Type": "AWS::Lambda::LayerVersion",
            "Properties": {
                "Content": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210.zip"
                },
                "CompatibleRuntimes": [
                    "python3.9"
                ],
                "Description": "Shared dependencies"
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/CheckUserID/SharedDeps/Resource",
                "aws:asset:path": "asset.d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Content"
            }
        },
        "UserPortalFunctionsIndexFacesRole2B346555": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "lambda.amazonaws.com"
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "Description": "RivUserPortalIndexFaces for the IndexFaces component.",
                "ManagedPolicyArns": [
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AWSXRayDaemonWriteAccess"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AmazonRekognitionFullAccess"
                            ]
                        ]
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/IndexFaces/Role/Resource"
            }
        },
        "UserPortalFunctionsIndexFacesRoleDefaultPolicyE258D60E": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": "ssm:GetParameter*",
                            "Effect": "Allow",
                            "Resource": {
                                "Fn::Join": [
                                    "",
                                    [
                                        "arn:aws:ssm:",
                                        {
                                            "Ref": "AWS::Region"
                                        },
                                        ":",
                                        {
                                            "Ref": "AWS::AccountId"
                                        },
                                        ":parameter/riv/Riv-Prod/rekognition/*"
                                    ]
                                ]
                            }
                        },
                        {
                            "Action": [
                                "dynamodb:BatchGetItem",
                                "dynamodb:GetRecords",
                                "dynamodb:GetShardIterator",
                                "dynamodb:Query",
                                "dynamodb:GetItem",
                                "dynamodb:Scan",
                                "dynamodb:ConditionCheckItem",
                                "dynamodb:BatchWriteItem",
                                "dynamodb:PutItem",
                                "dynamodb:UpdateItem",
                                "dynamodb:DeleteItem",
                                "dynamodb:DescribeTable"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "SharedStorageMetadataFaceTable609BE09F",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Ref": "AWS::NoValue"
                                }
                            ]
                        },
                        {
                            "Action": [
                                "s3:PutObject",
                                "s3:PutObjectLegalHold",
                                "s3:PutObjectRetention",
                                "s3:PutObjectTagging",
                                "s3:PutObjectVersionTagging",
                                "s3:Abort*"
                            ],
                            "Effect": "Allow",
                            "Resource": {
                                "Fn::Join": [
                                    "",
                                    [
                                        {
                                            "Fn::GetAtt": [
                                                "SharedStorageImagesImageBucket7DE5900F",
                                                "Arn"
                                            ]
                                        },
                                        "/*"
                                    ]
                                ]
                            }
                        },
                        {
                            "Action": [
                                "s3:GetObject*",
                                "s3:GetBucket*",
                                "s3:List*"
                            ],
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "SharedStorageImagesImageBucket7DE5900F",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "SharedStorageImagesImageBucket7DE5900F",
                                                    "Arn"
                                                ]
                                            },
                                            "/*"
                                        ]
                                    ]
                                }
                            ]
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "UserPortalFunctionsIndexFacesRoleDefaultPolicyE258D60E",
                "Roles": [
                    {
                        "Ref": "UserPortalFunctionsIndexFacesRole2B346555"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/IndexFaces/Role/DefaultPolicy/Resource"
            }
        },
        "UserPortalFunctionsIndexFacesLambdaFunction6555F0B7": {
            "Type": "AWS::Lambda::Function",
            "Properties": {
                "Code": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/a2b4afd13634f62fa21e94fe88a6473e5abd405ddb04825c921883793c3ce1c6.zip"
                },
                "Role": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsIndexFacesRole2B346555",
                        "Arn"
                    ]
                },
                "Description": "Python container lambda function for IndexFaces",
                "Environment": {
                    "Variables": {
                        "REGION": {
                            "Ref": "AWS::Region"
                        },
                        "RIV_STACK_NAME": {
                            "Ref": "AWS::StackName"
                        },
                        "FACE_TABLE_NAME": {
                            "Ref": "SharedStorageMetadataFaceTable609BE09F"
                        },
                        "IMAGE_BUCKET_NAME": {
                            "Ref": "SharedStorageImagesImageBucket7DE5900F"
                        }
                    }
                },
                "Handler": "handler.function_main",
                "Layers": [
                    {
                        "Ref": "UserPortalFunctionsIndexFacesSharedDepsCB1DAA9F"
                    }
                ],
                "MemorySize": 512,
                "Runtime": "python3.9",
                "Timeout": 30,
                "TracingConfig": {
                    "Mode": "Active"
                }
            },
            "DependsOn": [
                "UserPortalFunctionsIndexFacesRoleDefaultPolicyE258D60E",
                "UserPortalFunctionsIndexFacesRole2B346555"
            ],
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/IndexFaces/LambdaFunction/Resource",
                "aws:asset:path": "asset.a2b4afd13634f62fa21e94fe88a6473e5abd405ddb04825c921883793c3ce1c6",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Code"
            }
        },
        "UserPortalFunctionsIndexFacesSharedDepsCB1DAA9F": {
            "Type": "AWS::Lambda::LayerVersion",
            "Properties": {
                "Content": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210.zip"
                },
                "CompatibleRuntimes": [
                    "python3.9"
                ],
                "Description": "Shared dependencies"
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Functions/IndexFaces/SharedDeps/Resource",
                "aws:asset:path": "asset.d54e278e40c10e2feee8878ed168bc02a5be3f3b9c6405ff16dfb58d654ec210",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Content"
            }
        },
        "UserPortalGatewayUserPortal1E4ECB13": {
            "Type": "AWS::ApiGateway::RestApi",
            "Properties": {
                "Description": "Gateway for RivUserPortalGateway",
                "Name": "Riv-Prod-UserPortal"
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Resource"
            }
        },
        "UserPortalGatewayUserPortalCloudWatchRoleDF5FFE06": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "apigateway.amazonaws.com"
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "ManagedPolicyArns": [
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs"
                            ]
                        ]
                    }
                ]
            },
            "UpdateReplacePolicy": "Retain",
            "DeletionPolicy": "Retain",
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/CloudWatchRole/Resource"
            }
        },
        "UserPortalGatewayUserPortalAccount27E32CA6": {
            "Type": "AWS::ApiGateway::Account",
            "Properties": {
                "CloudWatchRoleArn": {
                    "Fn::GetAtt": [
                        "UserPortalGatewayUserPortalCloudWatchRoleDF5FFE06",
                        "Arn"
                    ]
                }
            },
            "DependsOn": [
                "UserPortalGatewayUserPortal1E4ECB13"
            ],
            "UpdateReplacePolicy": "Retain",
            "DeletionPolicy": "Retain",
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Account"
            }
        },
        "UserPortalGatewayUserPortalDeployment0587A3E1620ce4a979f4053f8e85377c72b777a3": {
            "Type": "AWS::ApiGateway::Deployment",
            "Properties": {
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "Description": "Gateway for RivUserPortalGateway"
            },
            "DependsOn": [
                "UserPortalGatewayModelsAuthenticateRequestFB958DEC",
                "UserPortalGatewayModelsAuthenticateUserResponse955C723F",
                "UserPortalGatewayModelsRegisterIdCardRequest233A1A2C",
                "UserPortalGatewayModelsRegisterUserRequest1C8965E9",
                "UserPortalGatewayModelsRegisterUserResponse6B39DB57",
                "UserPortalGatewayModelsUpdateUserRequest17A1D07F",
                "UserPortalGatewayModelsUpdateUserResponse9EB11910",
                "UserPortalGatewayUserPortalauthOPTIONS37D1C955",
                "UserPortalGatewayUserPortalauthPOSTF9F22DE9",
                "UserPortalGatewayUserPortalauth5BE56259",
                "UserPortalGatewayUserPortalcheckuseridOPTIONSF025758D",
                "UserPortalGatewayUserPortalcheckuseridPOST4A09CFAE",
                "UserPortalGatewayUserPortalcheckuserid3E4B906D",
                "UserPortalGatewayUserPortalextractidcardOPTIONS071DFCD3",
                "UserPortalGatewayUserPortalextractidcardPOSTACB3D84C",
                "UserPortalGatewayUserPortalextractidcardAAB52CA6",
                "UserPortalGatewayUserPortallivenesssessionresultOPTIONS0FE98C1D",
                "UserPortalGatewayUserPortallivenesssessionresultPOST5D08420E",
                "UserPortalGatewayUserPortallivenesssessionresult923D3DEA",
                "UserPortalGatewayUserPortalregisteridcardOPTIONSE68423D1",
                "UserPortalGatewayUserPortalregisteridcardPOSTBA092160",
                "UserPortalGatewayUserPortalregisteridcardEA71D997",
                "UserPortalGatewayUserPortalregisterOPTIONS01BD90E4",
                "UserPortalGatewayUserPortalregisterPOSTED32B081",
                "UserPortalGatewayUserPortalregisterBF491C41",
                "UserPortalGatewayUserPortalresetuserGETFA94F80B",
                "UserPortalGatewayUserPortalresetuserOPTIONS11A86403",
                "UserPortalGatewayUserPortalresetuser08DDCBCA",
                "UserPortalGatewayUserPortalstartlivenesssessionGETA801E478",
                "UserPortalGatewayUserPortalstartlivenesssessionOPTIONSD9071961",
                "UserPortalGatewayUserPortalstartlivenesssessionE42482FC",
                "UserPortalGatewayUserPortalupdateOPTIONS1FED7AD4",
                "UserPortalGatewayUserPortalupdatePOSTBE2945B5",
                "UserPortalGatewayUserPortalupdate3AED6692"
            ],
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Deployment/Resource"
            }
        },
        "UserPortalGatewayUserPortalDeploymentStageprod784D2EBD": {
            "Type": "AWS::ApiGateway::Stage",
            "Properties": {
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "DeploymentId": {
                    "Ref": "UserPortalGatewayUserPortalDeployment0587A3E1620ce4a979f4053f8e85377c72b777a3"
                },
                "StageName": "prod"
            },
            "DependsOn": [
                "UserPortalGatewayUserPortalAccount27E32CA6"
            ],
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/DeploymentStage.prod/Resource"
            }
        },
        "UserPortalGatewayUserPortalregisteridcardEA71D997": {
            "Type": "AWS::ApiGateway::Resource",
            "Properties": {
                "ParentId": {
                    "Fn::GetAtt": [
                        "UserPortalGatewayUserPortal1E4ECB13",
                        "RootResourceId"
                    ]
                },
                "PathPart": "register-idcard",
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/register-idcard/Resource"
            }
        },
        "UserPortalGatewayUserPortalregisteridcardOPTIONSE68423D1": {
            "Type": "AWS::ApiGateway::Method",
            "Properties": {
                "HttpMethod": "OPTIONS",
                "ResourceId": {
                    "Ref": "UserPortalGatewayUserPortalregisteridcardEA71D997"
                },
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "AuthorizationType": "NONE",
                "Integration": {
                    "IntegrationResponses": [
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'",
                                "method.response.header.Access-Control-Allow-Origin": "'*'",
                                "method.response.header.Access-Control-Allow-Methods": "'OPTIONS,POST'",
                                "method.response.header.Access-Control-Allow-Credentials": "'true'"
                            },
                            "StatusCode": "204"
                        }
                    ],
                    "RequestTemplates": {
                        "application/json": "{ statusCode: 200 }"
                    },
                    "Type": "MOCK"
                },
                "MethodResponses": [
                    {
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Headers": true,
                            "method.response.header.Access-Control-Allow-Origin": true,
                            "method.response.header.Access-Control-Allow-Methods": true,
                            "method.response.header.Access-Control-Allow-Credentials": true
                        },
                        "StatusCode": "204"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/register-idcard/OPTIONS/Resource"
            }
        },
        "UserPortalGatewayUserPortalregisteridcardPOSTBA092160": {
            "Type": "AWS::ApiGateway::Method",
            "Properties": {
                "HttpMethod": "POST",
                "ResourceId": {
                    "Ref": "UserPortalGatewayUserPortalregisteridcardEA71D997"
                },
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "AuthorizationType": "NONE",
                "Integration": {
                    "Credentials": {
                        "Fn::GetAtt": [
                            "UserPortalGatewayRole348935C3",
                            "Arn"
                        ]
                    },
                    "IntegrationHttpMethod": "POST",
                    "IntegrationResponses": [
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'",
                                "method.response.header.Access-Control-Allow-Methods": "'*'",
                                "method.response.header.Access-Control-Allow-Origin": "'*'"
                            },
                            "ResponseTemplates": {
                                "application/json": "$input.json('$')"
                            },
                            "SelectionPattern": "200",
                            "StatusCode": "200"
                        },
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'",
                                "method.response.header.Access-Control-Allow-Methods": "'*'",
                                "method.response.header.Access-Control-Allow-Origin": "'*'"
                            },
                            "ResponseTemplates": {
                                "application/json": "$input.json('$')"
                            },
                            "SelectionPattern": "500",
                            "StatusCode": "500"
                        }
                    ],
                    "RequestTemplates": {
                        "application/json": {
                            "Fn::Join": [
                                "",
                                [
                                    "\n  #set($input = $input.json('$')) {\n    \"stateMachineArn\": \"",
                                    {
                                        "Ref": "UserPortalStatesRegisterIdCardStateMachine83835B73"
                                    },
                                    "\",\n    \"input\": \"{ \\\"inputRequest\\\": $util.escapeJavaScript($input).replaceAll(\"\\'\", \"'\") }\"\n  }\n  "
                                ]
                            ]
                        }
                    },
                    "Type": "AWS",
                    "Uri": {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":apigateway:",
                                {
                                    "Ref": "AWS::Region"
                                },
                                ":states:action/StartSyncExecution"
                            ]
                        ]
                    }
                },
                "MethodResponses": [
                    {
                        "ResponseModels": {
                            "application/json": {
                                "Ref": "UserPortalGatewayModelsRegisterUserResponse6B39DB57"
                            }
                        },
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Headers": true,
                            "method.response.header.Access-Control-Allow-Methods": true,
                            "method.response.header.Access-Control-Allow-Origin": true
                        },
                        "StatusCode": "200"
                    },
                    {
                        "ResponseModels": {
                            "application/json": "Error"
                        },
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Headers": true,
                            "method.response.header.Access-Control-Allow-Methods": true,
                            "method.response.header.Access-Control-Allow-Origin": true
                        },
                        "StatusCode": "500"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/register-idcard/POST/Resource"
            }
        },
        "UserPortalGatewayUserPortalregisterBF491C41": {
            "Type": "AWS::ApiGateway::Resource",
            "Properties": {
                "ParentId": {
                    "Fn::GetAtt": [
                        "UserPortalGatewayUserPortal1E4ECB13",
                        "RootResourceId"
                    ]
                },
                "PathPart": "register",
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/register/Resource"
            }
        },
        "UserPortalGatewayUserPortalregisterOPTIONS01BD90E4": {
            "Type": "AWS::ApiGateway::Method",
            "Properties": {
                "HttpMethod": "OPTIONS",
                "ResourceId": {
                    "Ref": "UserPortalGatewayUserPortalregisterBF491C41"
                },
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "AuthorizationType": "NONE",
                "Integration": {
                    "IntegrationResponses": [
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'",
                                "method.response.header.Access-Control-Allow-Origin": "'*'",
                                "method.response.header.Access-Control-Allow-Methods": "'OPTIONS,POST'",
                                "method.response.header.Access-Control-Allow-Credentials": "'true'"
                            },
                            "StatusCode": "204"
                        }
                    ],
                    "RequestTemplates": {
                        "application/json": "{ statusCode: 200 }"
                    },
                    "Type": "MOCK"
                },
                "MethodResponses": [
                    {
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Headers": true,
                            "method.response.header.Access-Control-Allow-Origin": true,
                            "method.response.header.Access-Control-Allow-Methods": true,
                            "method.response.header.Access-Control-Allow-Credentials": true
                        },
                        "StatusCode": "204"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/register/OPTIONS/Resource"
            }
        },
        "UserPortalGatewayUserPortalregisterPOSTED32B081": {
            "Type": "AWS::ApiGateway::Method",
            "Properties": {
                "HttpMethod": "POST",
                "ResourceId": {
                    "Ref": "UserPortalGatewayUserPortalregisterBF491C41"
                },
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "AuthorizationType": "NONE",
                "Integration": {
                    "Credentials": {
                        "Fn::GetAtt": [
                            "UserPortalGatewayRole348935C3",
                            "Arn"
                        ]
                    },
                    "IntegrationHttpMethod": "POST",
                    "IntegrationResponses": [
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'",
                                "method.response.header.Access-Control-Allow-Methods": "'*'",
                                "method.response.header.Access-Control-Allow-Origin": "'*'"
                            },
                            "ResponseTemplates": {
                                "application/json": "$input.json('$')"
                            },
                            "SelectionPattern": "200",
                            "StatusCode": "200"
                        },
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'",
                                "method.response.header.Access-Control-Allow-Methods": "'*'",
                                "method.response.header.Access-Control-Allow-Origin": "'*'"
                            },
                            "ResponseTemplates": {
                                "application/json": "$input.json('$')"
                            },
                            "SelectionPattern": "500",
                            "StatusCode": "500"
                        }
                    ],
                    "RequestTemplates": {
                        "application/json": {
                            "Fn::Join": [
                                "",
                                [
                                    "\n  #set($input = $input.json('$')) {\n    \"stateMachineArn\": \"",
                                    {
                                        "Ref": "UserPortalStatesRegisterStateMachineB7136A77"
                                    },
                                    "\",\n    \"input\": \"{ \\\"inputRequest\\\": $util.escapeJavaScript($input).replaceAll(\"\\'\", \"'\") }\"\n  }\n  "
                                ]
                            ]
                        }
                    },
                    "Type": "AWS",
                    "Uri": {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":apigateway:",
                                {
                                    "Ref": "AWS::Region"
                                },
                                ":states:action/StartSyncExecution"
                            ]
                        ]
                    }
                },
                "MethodResponses": [
                    {
                        "ResponseModels": {
                            "application/json": {
                                "Ref": "UserPortalGatewayModelsRegisterUserResponse6B39DB57"
                            }
                        },
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Headers": true,
                            "method.response.header.Access-Control-Allow-Methods": true,
                            "method.response.header.Access-Control-Allow-Origin": true
                        },
                        "StatusCode": "200"
                    },
                    {
                        "ResponseModels": {
                            "application/json": "Error"
                        },
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Headers": true,
                            "method.response.header.Access-Control-Allow-Methods": true,
                            "method.response.header.Access-Control-Allow-Origin": true
                        },
                        "StatusCode": "500"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/register/POST/Resource"
            }
        },
        "UserPortalGatewayUserPortalupdate3AED6692": {
            "Type": "AWS::ApiGateway::Resource",
            "Properties": {
                "ParentId": {
                    "Fn::GetAtt": [
                        "UserPortalGatewayUserPortal1E4ECB13",
                        "RootResourceId"
                    ]
                },
                "PathPart": "update",
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/update/Resource"
            }
        },
        "UserPortalGatewayUserPortalupdateOPTIONS1FED7AD4": {
            "Type": "AWS::ApiGateway::Method",
            "Properties": {
                "HttpMethod": "OPTIONS",
                "ResourceId": {
                    "Ref": "UserPortalGatewayUserPortalupdate3AED6692"
                },
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "AuthorizationType": "NONE",
                "Integration": {
                    "IntegrationResponses": [
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'",
                                "method.response.header.Access-Control-Allow-Origin": "'*'",
                                "method.response.header.Access-Control-Allow-Methods": "'OPTIONS,POST'",
                                "method.response.header.Access-Control-Allow-Credentials": "'true'"
                            },
                            "StatusCode": "204"
                        }
                    ],
                    "RequestTemplates": {
                        "application/json": "{ statusCode: 200 }"
                    },
                    "Type": "MOCK"
                },
                "MethodResponses": [
                    {
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Headers": true,
                            "method.response.header.Access-Control-Allow-Origin": true,
                            "method.response.header.Access-Control-Allow-Methods": true,
                            "method.response.header.Access-Control-Allow-Credentials": true
                        },
                        "StatusCode": "204"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/update/OPTIONS/Resource"
            }
        },
        "UserPortalGatewayUserPortalupdatePOSTBE2945B5": {
            "Type": "AWS::ApiGateway::Method",
            "Properties": {
                "HttpMethod": "POST",
                "ResourceId": {
                    "Ref": "UserPortalGatewayUserPortalupdate3AED6692"
                },
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "AuthorizationType": "NONE",
                "Integration": {
                    "Credentials": {
                        "Fn::GetAtt": [
                            "UserPortalGatewayRole348935C3",
                            "Arn"
                        ]
                    },
                    "IntegrationHttpMethod": "POST",
                    "IntegrationResponses": [
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'",
                                "method.response.header.Access-Control-Allow-Methods": "'*'",
                                "method.response.header.Access-Control-Allow-Origin": "'*'"
                            },
                            "ResponseTemplates": {
                                "application/json": "$input.json('$')"
                            },
                            "SelectionPattern": "200",
                            "StatusCode": "200"
                        },
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'",
                                "method.response.header.Access-Control-Allow-Methods": "'*'",
                                "method.response.header.Access-Control-Allow-Origin": "'*'"
                            },
                            "ResponseTemplates": {
                                "application/json": "$input.json('$')"
                            },
                            "SelectionPattern": "500",
                            "StatusCode": "500"
                        }
                    ],
                    "RequestTemplates": {
                        "application/json": {
                            "Fn::Join": [
                                "",
                                [
                                    "\n  #set($input = $input.json('$')) {\n    \"stateMachineArn\": \"",
                                    {
                                        "Ref": "UserPortalStatesUpdateStateMachineC5A4EA2D"
                                    },
                                    "\",\n    \"input\": \"{ \\\"inputRequest\\\": $util.escapeJavaScript($input).replaceAll(\"\\'\", \"'\") }\"\n  }\n  "
                                ]
                            ]
                        }
                    },
                    "Type": "AWS",
                    "Uri": {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":apigateway:",
                                {
                                    "Ref": "AWS::Region"
                                },
                                ":states:action/StartSyncExecution"
                            ]
                        ]
                    }
                },
                "MethodResponses": [
                    {
                        "ResponseModels": {
                            "application/json": {
                                "Ref": "UserPortalGatewayModelsUpdateUserResponse9EB11910"
                            }
                        },
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Headers": true,
                            "method.response.header.Access-Control-Allow-Methods": true,
                            "method.response.header.Access-Control-Allow-Origin": true
                        },
                        "StatusCode": "200"
                    },
                    {
                        "ResponseModels": {
                            "application/json": "Error"
                        },
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Headers": true,
                            "method.response.header.Access-Control-Allow-Methods": true,
                            "method.response.header.Access-Control-Allow-Origin": true
                        },
                        "StatusCode": "500"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/update/POST/Resource"
            }
        },
        "UserPortalGatewayUserPortalauth5BE56259": {
            "Type": "AWS::ApiGateway::Resource",
            "Properties": {
                "ParentId": {
                    "Fn::GetAtt": [
                        "UserPortalGatewayUserPortal1E4ECB13",
                        "RootResourceId"
                    ]
                },
                "PathPart": "auth",
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/auth/Resource"
            }
        },
        "UserPortalGatewayUserPortalauthOPTIONS37D1C955": {
            "Type": "AWS::ApiGateway::Method",
            "Properties": {
                "HttpMethod": "OPTIONS",
                "ResourceId": {
                    "Ref": "UserPortalGatewayUserPortalauth5BE56259"
                },
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "AuthorizationType": "NONE",
                "Integration": {
                    "IntegrationResponses": [
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'",
                                "method.response.header.Access-Control-Allow-Origin": "'*'",
                                "method.response.header.Access-Control-Allow-Methods": "'OPTIONS,POST'",
                                "method.response.header.Access-Control-Allow-Credentials": "'true'"
                            },
                            "StatusCode": "204"
                        }
                    ],
                    "RequestTemplates": {
                        "application/json": "{ statusCode: 200 }"
                    },
                    "Type": "MOCK"
                },
                "MethodResponses": [
                    {
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Headers": true,
                            "method.response.header.Access-Control-Allow-Origin": true,
                            "method.response.header.Access-Control-Allow-Methods": true,
                            "method.response.header.Access-Control-Allow-Credentials": true
                        },
                        "StatusCode": "204"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/auth/OPTIONS/Resource"
            }
        },
        "UserPortalGatewayUserPortalauthPOSTF9F22DE9": {
            "Type": "AWS::ApiGateway::Method",
            "Properties": {
                "HttpMethod": "POST",
                "ResourceId": {
                    "Ref": "UserPortalGatewayUserPortalauth5BE56259"
                },
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "AuthorizationType": "NONE",
                "Integration": {
                    "Credentials": {
                        "Fn::GetAtt": [
                            "UserPortalGatewayRole348935C3",
                            "Arn"
                        ]
                    },
                    "IntegrationHttpMethod": "POST",
                    "IntegrationResponses": [
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'",
                                "method.response.header.Access-Control-Allow-Methods": "'*'",
                                "method.response.header.Access-Control-Allow-Origin": "'*'"
                            },
                            "ResponseTemplates": {
                                "application/json": "$input.json('$')"
                            },
                            "SelectionPattern": "200",
                            "StatusCode": "200"
                        },
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'",
                                "method.response.header.Access-Control-Allow-Methods": "'*'",
                                "method.response.header.Access-Control-Allow-Origin": "'*'"
                            },
                            "ResponseTemplates": {
                                "application/json": "$input.json('$')"
                            },
                            "SelectionPattern": "500",
                            "StatusCode": "500"
                        }
                    ],
                    "RequestTemplates": {
                        "application/json": {
                            "Fn::Join": [
                                "",
                                [
                                    "\n  #set($input = $input.json('$')) {\n    \"stateMachineArn\": \"",
                                    {
                                        "Ref": "UserPortalStatesAuthStateMachine89B3C1FA"
                                    },
                                    "\",\n    \"input\": \"{ \\\"inputRequest\\\": $util.escapeJavaScript($input).replaceAll(\"\\'\", \"'\") }\"\n  }\n  "
                                ]
                            ]
                        }
                    },
                    "Type": "AWS",
                    "Uri": {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":apigateway:",
                                {
                                    "Ref": "AWS::Region"
                                },
                                ":states:action/StartSyncExecution"
                            ]
                        ]
                    }
                },
                "MethodResponses": [
                    {
                        "ResponseModels": {
                            "application/json": {
                                "Ref": "UserPortalGatewayModelsAuthenticateUserResponse955C723F"
                            }
                        },
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Headers": true,
                            "method.response.header.Access-Control-Allow-Methods": true,
                            "method.response.header.Access-Control-Allow-Origin": true
                        },
                        "StatusCode": "200"
                    },
                    {
                        "ResponseModels": {
                            "application/json": "Error"
                        },
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Headers": true,
                            "method.response.header.Access-Control-Allow-Methods": true,
                            "method.response.header.Access-Control-Allow-Origin": true
                        },
                        "StatusCode": "500"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/auth/POST/Resource"
            }
        },
        "UserPortalGatewayUserPortalresetuser08DDCBCA": {
            "Type": "AWS::ApiGateway::Resource",
            "Properties": {
                "ParentId": {
                    "Fn::GetAtt": [
                        "UserPortalGatewayUserPortal1E4ECB13",
                        "RootResourceId"
                    ]
                },
                "PathPart": "reset-user",
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/reset-user/Resource"
            }
        },
        "UserPortalGatewayUserPortalresetuserOPTIONS11A86403": {
            "Type": "AWS::ApiGateway::Method",
            "Properties": {
                "HttpMethod": "OPTIONS",
                "ResourceId": {
                    "Ref": "UserPortalGatewayUserPortalresetuser08DDCBCA"
                },
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "AuthorizationType": "NONE",
                "Integration": {
                    "IntegrationResponses": [
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,X-Amz-User-Agent'",
                                "method.response.header.Access-Control-Allow-Origin": "'*'",
                                "method.response.header.Access-Control-Allow-Methods": "'OPTIONS,GET'"
                            },
                            "StatusCode": "204"
                        }
                    ],
                    "RequestTemplates": {
                        "application/json": "{ statusCode: 200 }"
                    },
                    "Type": "MOCK"
                },
                "MethodResponses": [
                    {
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Headers": true,
                            "method.response.header.Access-Control-Allow-Origin": true,
                            "method.response.header.Access-Control-Allow-Methods": true
                        },
                        "StatusCode": "204"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/reset-user/OPTIONS/Resource"
            }
        },
        "UserPortalGatewayUserPortalresetuserGETApiPermissionRivProdUserPortalGatewayUserPortal50FAEFC0GETresetuserF1DFC08D": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsResetUserLambdaFunction42DCB7C0",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:",
                            {
                                "Ref": "AWS::Region"
                            },
                            ":",
                            {
                                "Ref": "AWS::AccountId"
                            },
                            ":",
                            {
                                "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                            },
                            "/",
                            {
                                "Ref": "UserPortalGatewayUserPortalDeploymentStageprod784D2EBD"
                            },
                            "/GET/reset-user"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/reset-user/GET/ApiPermission.RivProdUserPortalGatewayUserPortal50FAEFC0.GET..reset-user"
            }
        },
        "UserPortalGatewayUserPortalresetuserGETApiPermissionTestRivProdUserPortalGatewayUserPortal50FAEFC0GETresetuser4F0F7109": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsResetUserLambdaFunction42DCB7C0",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:",
                            {
                                "Ref": "AWS::Region"
                            },
                            ":",
                            {
                                "Ref": "AWS::AccountId"
                            },
                            ":",
                            {
                                "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                            },
                            "/test-invoke-stage/GET/reset-user"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/reset-user/GET/ApiPermission.Test.RivProdUserPortalGatewayUserPortal50FAEFC0.GET..reset-user"
            }
        },
        "UserPortalGatewayUserPortalresetuserGETFA94F80B": {
            "Type": "AWS::ApiGateway::Method",
            "Properties": {
                "HttpMethod": "GET",
                "ResourceId": {
                    "Ref": "UserPortalGatewayUserPortalresetuser08DDCBCA"
                },
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "AuthorizationType": "NONE",
                "Integration": {
                    "IntegrationHttpMethod": "POST",
                    "IntegrationResponses": [
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Origin": "'*'"
                            },
                            "StatusCode": "200"
                        },
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Origin": "'*'"
                            },
                            "StatusCode": "500"
                        }
                    ],
                    "Type": "AWS",
                    "Uri": {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":apigateway:",
                                {
                                    "Ref": "AWS::Region"
                                },
                                ":lambda:path/2015-03-31/functions/",
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsResetUserLambdaFunction42DCB7C0",
                                        "Arn"
                                    ]
                                },
                                "/invocations"
                            ]
                        ]
                    }
                },
                "MethodResponses": [
                    {
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Origin": true
                        },
                        "StatusCode": "200"
                    },
                    {
                        "ResponseModels": {
                            "application/json": "Error"
                        },
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Origin": true
                        },
                        "StatusCode": "500"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/reset-user/GET/Resource"
            }
        },
        "UserPortalGatewayUserPortalstartlivenesssessionE42482FC": {
            "Type": "AWS::ApiGateway::Resource",
            "Properties": {
                "ParentId": {
                    "Fn::GetAtt": [
                        "UserPortalGatewayUserPortal1E4ECB13",
                        "RootResourceId"
                    ]
                },
                "PathPart": "start-liveness-session",
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/start-liveness-session/Resource"
            }
        },
        "UserPortalGatewayUserPortalstartlivenesssessionOPTIONSD9071961": {
            "Type": "AWS::ApiGateway::Method",
            "Properties": {
                "HttpMethod": "OPTIONS",
                "ResourceId": {
                    "Ref": "UserPortalGatewayUserPortalstartlivenesssessionE42482FC"
                },
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "AuthorizationType": "NONE",
                "Integration": {
                    "IntegrationResponses": [
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,X-Amz-User-Agent'",
                                "method.response.header.Access-Control-Allow-Origin": "'*'",
                                "method.response.header.Access-Control-Allow-Methods": "'OPTIONS,GET'"
                            },
                            "StatusCode": "204"
                        }
                    ],
                    "RequestTemplates": {
                        "application/json": "{ statusCode: 200 }"
                    },
                    "Type": "MOCK"
                },
                "MethodResponses": [
                    {
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Headers": true,
                            "method.response.header.Access-Control-Allow-Origin": true,
                            "method.response.header.Access-Control-Allow-Methods": true
                        },
                        "StatusCode": "204"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/start-liveness-session/OPTIONS/Resource"
            }
        },
        "UserPortalGatewayUserPortalstartlivenesssessionGETApiPermissionRivProdUserPortalGatewayUserPortal50FAEFC0GETstartlivenesssessionB919C901": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsStartLivenessSesstionLambdaFunctionAF5D813E",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:",
                            {
                                "Ref": "AWS::Region"
                            },
                            ":",
                            {
                                "Ref": "AWS::AccountId"
                            },
                            ":",
                            {
                                "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                            },
                            "/",
                            {
                                "Ref": "UserPortalGatewayUserPortalDeploymentStageprod784D2EBD"
                            },
                            "/GET/start-liveness-session"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/start-liveness-session/GET/ApiPermission.RivProdUserPortalGatewayUserPortal50FAEFC0.GET..start-liveness-session"
            }
        },
        "UserPortalGatewayUserPortalstartlivenesssessionGETApiPermissionTestRivProdUserPortalGatewayUserPortal50FAEFC0GETstartlivenesssession07804964": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsStartLivenessSesstionLambdaFunctionAF5D813E",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:",
                            {
                                "Ref": "AWS::Region"
                            },
                            ":",
                            {
                                "Ref": "AWS::AccountId"
                            },
                            ":",
                            {
                                "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                            },
                            "/test-invoke-stage/GET/start-liveness-session"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/start-liveness-session/GET/ApiPermission.Test.RivProdUserPortalGatewayUserPortal50FAEFC0.GET..start-liveness-session"
            }
        },
        "UserPortalGatewayUserPortalstartlivenesssessionGETA801E478": {
            "Type": "AWS::ApiGateway::Method",
            "Properties": {
                "HttpMethod": "GET",
                "ResourceId": {
                    "Ref": "UserPortalGatewayUserPortalstartlivenesssessionE42482FC"
                },
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "AuthorizationType": "NONE",
                "Integration": {
                    "IntegrationHttpMethod": "POST",
                    "IntegrationResponses": [
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Origin": "'*'"
                            },
                            "StatusCode": "200"
                        },
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Origin": "'*'"
                            },
                            "StatusCode": "500"
                        }
                    ],
                    "Type": "AWS",
                    "Uri": {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":apigateway:",
                                {
                                    "Ref": "AWS::Region"
                                },
                                ":lambda:path/2015-03-31/functions/",
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsStartLivenessSesstionLambdaFunctionAF5D813E",
                                        "Arn"
                                    ]
                                },
                                "/invocations"
                            ]
                        ]
                    }
                },
                "MethodResponses": [
                    {
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Origin": true
                        },
                        "StatusCode": "200"
                    },
                    {
                        "ResponseModels": {
                            "application/json": "Error"
                        },
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Origin": true
                        },
                        "StatusCode": "500"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/start-liveness-session/GET/Resource"
            }
        },
        "UserPortalGatewayUserPortallivenesssessionresult923D3DEA": {
            "Type": "AWS::ApiGateway::Resource",
            "Properties": {
                "ParentId": {
                    "Fn::GetAtt": [
                        "UserPortalGatewayUserPortal1E4ECB13",
                        "RootResourceId"
                    ]
                },
                "PathPart": "liveness-session-result",
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/liveness-session-result/Resource"
            }
        },
        "UserPortalGatewayUserPortallivenesssessionresultOPTIONS0FE98C1D": {
            "Type": "AWS::ApiGateway::Method",
            "Properties": {
                "HttpMethod": "OPTIONS",
                "ResourceId": {
                    "Ref": "UserPortalGatewayUserPortallivenesssessionresult923D3DEA"
                },
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "AuthorizationType": "NONE",
                "Integration": {
                    "IntegrationResponses": [
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,X-Amz-User-Agent'",
                                "method.response.header.Access-Control-Allow-Origin": "'*'",
                                "method.response.header.Access-Control-Allow-Methods": "'OPTIONS,POST'"
                            },
                            "StatusCode": "204"
                        }
                    ],
                    "RequestTemplates": {
                        "application/json": "{ statusCode: 200 }"
                    },
                    "Type": "MOCK"
                },
                "MethodResponses": [
                    {
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Headers": true,
                            "method.response.header.Access-Control-Allow-Origin": true,
                            "method.response.header.Access-Control-Allow-Methods": true
                        },
                        "StatusCode": "204"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/liveness-session-result/OPTIONS/Resource"
            }
        },
        "UserPortalGatewayUserPortallivenesssessionresultPOSTApiPermissionRivProdUserPortalGatewayUserPortal50FAEFC0POSTlivenesssessionresult2475DC36": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsLivenessSesstionResultLambdaFunction45774E6D",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:",
                            {
                                "Ref": "AWS::Region"
                            },
                            ":",
                            {
                                "Ref": "AWS::AccountId"
                            },
                            ":",
                            {
                                "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                            },
                            "/",
                            {
                                "Ref": "UserPortalGatewayUserPortalDeploymentStageprod784D2EBD"
                            },
                            "/POST/liveness-session-result"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/liveness-session-result/POST/ApiPermission.RivProdUserPortalGatewayUserPortal50FAEFC0.POST..liveness-session-result"
            }
        },
        "UserPortalGatewayUserPortallivenesssessionresultPOSTApiPermissionTestRivProdUserPortalGatewayUserPortal50FAEFC0POSTlivenesssessionresultA5D25DD9": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsLivenessSesstionResultLambdaFunction45774E6D",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:",
                            {
                                "Ref": "AWS::Region"
                            },
                            ":",
                            {
                                "Ref": "AWS::AccountId"
                            },
                            ":",
                            {
                                "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                            },
                            "/test-invoke-stage/POST/liveness-session-result"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/liveness-session-result/POST/ApiPermission.Test.RivProdUserPortalGatewayUserPortal50FAEFC0.POST..liveness-session-result"
            }
        },
        "UserPortalGatewayUserPortallivenesssessionresultPOST5D08420E": {
            "Type": "AWS::ApiGateway::Method",
            "Properties": {
                "HttpMethod": "POST",
                "ResourceId": {
                    "Ref": "UserPortalGatewayUserPortallivenesssessionresult923D3DEA"
                },
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "AuthorizationType": "NONE",
                "Integration": {
                    "IntegrationHttpMethod": "POST",
                    "IntegrationResponses": [
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Origin": "'*'"
                            },
                            "StatusCode": "200"
                        },
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Origin": "'*'"
                            },
                            "StatusCode": "500"
                        }
                    ],
                    "Type": "AWS",
                    "Uri": {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":apigateway:",
                                {
                                    "Ref": "AWS::Region"
                                },
                                ":lambda:path/2015-03-31/functions/",
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsLivenessSesstionResultLambdaFunction45774E6D",
                                        "Arn"
                                    ]
                                },
                                "/invocations"
                            ]
                        ]
                    }
                },
                "MethodResponses": [
                    {
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Origin": true
                        },
                        "StatusCode": "200"
                    },
                    {
                        "ResponseModels": {
                            "application/json": "Error"
                        },
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Origin": true
                        },
                        "StatusCode": "500"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/liveness-session-result/POST/Resource"
            }
        },
        "UserPortalGatewayUserPortalcheckuserid3E4B906D": {
            "Type": "AWS::ApiGateway::Resource",
            "Properties": {
                "ParentId": {
                    "Fn::GetAtt": [
                        "UserPortalGatewayUserPortal1E4ECB13",
                        "RootResourceId"
                    ]
                },
                "PathPart": "check-userid",
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/check-userid/Resource"
            }
        },
        "UserPortalGatewayUserPortalcheckuseridOPTIONSF025758D": {
            "Type": "AWS::ApiGateway::Method",
            "Properties": {
                "HttpMethod": "OPTIONS",
                "ResourceId": {
                    "Ref": "UserPortalGatewayUserPortalcheckuserid3E4B906D"
                },
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "AuthorizationType": "NONE",
                "Integration": {
                    "IntegrationResponses": [
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,X-Amz-User-Agent'",
                                "method.response.header.Access-Control-Allow-Origin": "'*'",
                                "method.response.header.Access-Control-Allow-Methods": "'OPTIONS,POST'"
                            },
                            "StatusCode": "204"
                        }
                    ],
                    "RequestTemplates": {
                        "application/json": "{ statusCode: 200 }"
                    },
                    "Type": "MOCK"
                },
                "MethodResponses": [
                    {
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Headers": true,
                            "method.response.header.Access-Control-Allow-Origin": true,
                            "method.response.header.Access-Control-Allow-Methods": true
                        },
                        "StatusCode": "204"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/check-userid/OPTIONS/Resource"
            }
        },
        "UserPortalGatewayUserPortalcheckuseridPOSTApiPermissionRivProdUserPortalGatewayUserPortal50FAEFC0POSTcheckuserid5799E3EA": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsCheckUserIDLambdaFunction0189D9DC",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:",
                            {
                                "Ref": "AWS::Region"
                            },
                            ":",
                            {
                                "Ref": "AWS::AccountId"
                            },
                            ":",
                            {
                                "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                            },
                            "/",
                            {
                                "Ref": "UserPortalGatewayUserPortalDeploymentStageprod784D2EBD"
                            },
                            "/POST/check-userid"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/check-userid/POST/ApiPermission.RivProdUserPortalGatewayUserPortal50FAEFC0.POST..check-userid"
            }
        },
        "UserPortalGatewayUserPortalcheckuseridPOSTApiPermissionTestRivProdUserPortalGatewayUserPortal50FAEFC0POSTcheckuserid9A4EF367": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsCheckUserIDLambdaFunction0189D9DC",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:",
                            {
                                "Ref": "AWS::Region"
                            },
                            ":",
                            {
                                "Ref": "AWS::AccountId"
                            },
                            ":",
                            {
                                "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                            },
                            "/test-invoke-stage/POST/check-userid"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/check-userid/POST/ApiPermission.Test.RivProdUserPortalGatewayUserPortal50FAEFC0.POST..check-userid"
            }
        },
        "UserPortalGatewayUserPortalcheckuseridPOST4A09CFAE": {
            "Type": "AWS::ApiGateway::Method",
            "Properties": {
                "HttpMethod": "POST",
                "ResourceId": {
                    "Ref": "UserPortalGatewayUserPortalcheckuserid3E4B906D"
                },
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "AuthorizationType": "NONE",
                "Integration": {
                    "IntegrationHttpMethod": "POST",
                    "IntegrationResponses": [
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Origin": "'*'"
                            },
                            "StatusCode": "200"
                        },
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Origin": "'*'"
                            },
                            "StatusCode": "500"
                        }
                    ],
                    "Type": "AWS",
                    "Uri": {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":apigateway:",
                                {
                                    "Ref": "AWS::Region"
                                },
                                ":lambda:path/2015-03-31/functions/",
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsCheckUserIDLambdaFunction0189D9DC",
                                        "Arn"
                                    ]
                                },
                                "/invocations"
                            ]
                        ]
                    }
                },
                "MethodResponses": [
                    {
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Origin": true
                        },
                        "StatusCode": "200"
                    },
                    {
                        "ResponseModels": {
                            "application/json": "Error"
                        },
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Origin": true
                        },
                        "StatusCode": "500"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/check-userid/POST/Resource"
            }
        },
        "UserPortalGatewayUserPortalextractidcardAAB52CA6": {
            "Type": "AWS::ApiGateway::Resource",
            "Properties": {
                "ParentId": {
                    "Fn::GetAtt": [
                        "UserPortalGatewayUserPortal1E4ECB13",
                        "RootResourceId"
                    ]
                },
                "PathPart": "extract-idcard",
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/extract-idcard/Resource"
            }
        },
        "UserPortalGatewayUserPortalextractidcardOPTIONS071DFCD3": {
            "Type": "AWS::ApiGateway::Method",
            "Properties": {
                "HttpMethod": "OPTIONS",
                "ResourceId": {
                    "Ref": "UserPortalGatewayUserPortalextractidcardAAB52CA6"
                },
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "AuthorizationType": "NONE",
                "Integration": {
                    "IntegrationResponses": [
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Headers": "'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,X-Amz-User-Agent'",
                                "method.response.header.Access-Control-Allow-Origin": "'*'",
                                "method.response.header.Access-Control-Allow-Methods": "'OPTIONS,POST'"
                            },
                            "StatusCode": "204"
                        }
                    ],
                    "RequestTemplates": {
                        "application/json": "{ statusCode: 200 }"
                    },
                    "Type": "MOCK"
                },
                "MethodResponses": [
                    {
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Headers": true,
                            "method.response.header.Access-Control-Allow-Origin": true,
                            "method.response.header.Access-Control-Allow-Methods": true
                        },
                        "StatusCode": "204"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/extract-idcard/OPTIONS/Resource"
            }
        },
        "UserPortalGatewayUserPortalextractidcardPOSTApiPermissionRivProdUserPortalGatewayUserPortal50FAEFC0POSTextractidcard9857024E": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsExtractIdCardLambdaFunctionB2515571",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:",
                            {
                                "Ref": "AWS::Region"
                            },
                            ":",
                            {
                                "Ref": "AWS::AccountId"
                            },
                            ":",
                            {
                                "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                            },
                            "/",
                            {
                                "Ref": "UserPortalGatewayUserPortalDeploymentStageprod784D2EBD"
                            },
                            "/POST/extract-idcard"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/extract-idcard/POST/ApiPermission.RivProdUserPortalGatewayUserPortal50FAEFC0.POST..extract-idcard"
            }
        },
        "UserPortalGatewayUserPortalextractidcardPOSTApiPermissionTestRivProdUserPortalGatewayUserPortal50FAEFC0POSTextractidcardC705241E": {
            "Type": "AWS::Lambda::Permission",
            "Properties": {
                "Action": "lambda:InvokeFunction",
                "FunctionName": {
                    "Fn::GetAtt": [
                        "UserPortalFunctionsExtractIdCardLambdaFunctionB2515571",
                        "Arn"
                    ]
                },
                "Principal": "apigateway.amazonaws.com",
                "SourceArn": {
                    "Fn::Join": [
                        "",
                        [
                            "arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":execute-api:",
                            {
                                "Ref": "AWS::Region"
                            },
                            ":",
                            {
                                "Ref": "AWS::AccountId"
                            },
                            ":",
                            {
                                "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                            },
                            "/test-invoke-stage/POST/extract-idcard"
                        ]
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/extract-idcard/POST/ApiPermission.Test.RivProdUserPortalGatewayUserPortal50FAEFC0.POST..extract-idcard"
            }
        },
        "UserPortalGatewayUserPortalextractidcardPOSTACB3D84C": {
            "Type": "AWS::ApiGateway::Method",
            "Properties": {
                "HttpMethod": "POST",
                "ResourceId": {
                    "Ref": "UserPortalGatewayUserPortalextractidcardAAB52CA6"
                },
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "AuthorizationType": "NONE",
                "Integration": {
                    "IntegrationHttpMethod": "POST",
                    "IntegrationResponses": [
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Origin": "'*'"
                            },
                            "StatusCode": "200"
                        },
                        {
                            "ResponseParameters": {
                                "method.response.header.Access-Control-Allow-Origin": "'*'"
                            },
                            "StatusCode": "500"
                        }
                    ],
                    "Type": "AWS",
                    "Uri": {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":apigateway:",
                                {
                                    "Ref": "AWS::Region"
                                },
                                ":lambda:path/2015-03-31/functions/",
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsExtractIdCardLambdaFunctionB2515571",
                                        "Arn"
                                    ]
                                },
                                "/invocations"
                            ]
                        ]
                    }
                },
                "MethodResponses": [
                    {
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Origin": true
                        },
                        "StatusCode": "200"
                    },
                    {
                        "ResponseModels": {
                            "application/json": "Error"
                        },
                        "ResponseParameters": {
                            "method.response.header.Access-Control-Allow-Origin": true
                        },
                        "StatusCode": "500"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/UserPortal/Default/extract-idcard/POST/Resource"
            }
        },
        "UserPortalGatewayModelsRegisterUserRequest1C8965E9": {
            "Type": "AWS::ApiGateway::Model",
            "Properties": {
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "ContentType": "application/json",
                "Description": "Enroll a new user within the system.",
                "Name": "RegisterUserRequest",
                "Schema": {
                    "properties": {
                        "UserId": {
                            "description": "Primary identifier for the user.",
                            "type": "string"
                        },
                        "Image": {
                            "description": "utf8(base64( image ))",
                            "type": "string"
                        },
                        "Properties": {
                            "description": "An arbitrary property bag.",
                            "type": "object"
                        }
                    },
                    "required": [
                        "UserId",
                        "Image",
                        "Properties"
                    ],
                    "type": "object",
                    "$schema": "http://json-schema.org/draft-04/schema#"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/Models/RegisterUserRequest/Resource"
            }
        },
        "UserPortalGatewayModelsUpdateUserRequest17A1D07F": {
            "Type": "AWS::ApiGateway::Model",
            "Properties": {
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "ContentType": "application/json",
                "Description": "Update an existing users profile.",
                "Name": "UpdateUserRequest",
                "Schema": {
                    "properties": {
                        "UserId": {
                            "description": "Primary identifier for the user.",
                            "type": "string"
                        },
                        "Image": {
                            "description": "utf8(base64( image ))",
                            "type": "string"
                        },
                        "Properties": {
                            "description": "An arbitrary property bag.",
                            "type": "object"
                        }
                    },
                    "required": [
                        "UserId",
                        "Image",
                        "Properties"
                    ],
                    "type": "object",
                    "$schema": "http://json-schema.org/draft-04/schema#"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/Models/UpdateUserRequest/Resource"
            }
        },
        "UserPortalGatewayModelsRegisterIdCardRequest233A1A2C": {
            "Type": "AWS::ApiGateway::Model",
            "Properties": {
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "ContentType": "application/json",
                "Description": "Registers a new user with a valid id card.",
                "Name": "RegisterWithIdCardRequest",
                "Schema": {
                    "properties": {
                        "UserId": {
                            "description": "Primary identifier for the user.",
                            "type": "string"
                        },
                        "Image": {
                            "description": "utf8(base64( image ))",
                            "type": "string"
                        },
                        "IdCard": {
                            "description": "utf8(base64( image ))",
                            "type": "string"
                        },
                        "Properties": {
                            "description": "An arbitrary property bag.",
                            "type": "object"
                        }
                    },
                    "required": [
                        "UserId",
                        "Image",
                        "IdCard",
                        "Properties"
                    ],
                    "type": "object",
                    "$schema": "http://json-schema.org/draft-04/schema#"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/Models/RegisterIdCardRequest/Resource"
            }
        },
        "UserPortalGatewayModelsAuthenticateRequestFB958DEC": {
            "Type": "AWS::ApiGateway::Model",
            "Properties": {
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "ContentType": "application/json",
                "Description": "Verifies the caller matches their onfile photo",
                "Name": "AuthenticateUserRequest",
                "Schema": {
                    "properties": {
                        "UserId": {
                            "description": "Primary identifier for the user.",
                            "type": "string"
                        },
                        "Image": {
                            "description": "utf8(base64( image ))",
                            "type": "string"
                        }
                    },
                    "required": [
                        "UserId",
                        "Image"
                    ],
                    "type": "object",
                    "$schema": "http://json-schema.org/draft-04/schema#"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/Models/AuthenticateRequest/Resource"
            }
        },
        "UserPortalGatewayModelsRegisterUserResponse6B39DB57": {
            "Type": "AWS::ApiGateway::Model",
            "Properties": {
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "ContentType": "application/json",
                "Description": "Output from the Register operation.",
                "Name": "RegisterUserResponse",
                "Schema": {
                    "description": "The response from a register user flow.",
                    "properties": {
                        "UserId": {
                            "description": "Primary identifier for the user.",
                            "type": "string"
                        },
                        "ImageId": {
                            "description": "Internal identifier for the user.",
                            "type": "string"
                        },
                        "Status": {
                            "description": "Outcome of the Register operation.",
                            "type": "string"
                        }
                    },
                    "required": [
                        "UserId",
                        "ImageId",
                        "Status"
                    ],
                    "type": "object",
                    "$schema": "http://json-schema.org/draft-04/schema#"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/Models/RegisterUserResponse/Resource"
            }
        },
        "UserPortalGatewayModelsUpdateUserResponse9EB11910": {
            "Type": "AWS::ApiGateway::Model",
            "Properties": {
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "ContentType": "application/json",
                "Description": "Output from the Update operation.",
                "Name": "UpdateUserResponse",
                "Schema": {
                    "description": "The response from a update user flow.",
                    "properties": {
                        "UserId": {
                            "description": "Primary identifier for the user.",
                            "type": "string"
                        },
                        "ImageId": {
                            "description": "Internal identifier for the user.",
                            "type": "string"
                        },
                        "Status": {
                            "description": "Outcome of the Update operation.",
                            "type": "string"
                        }
                    },
                    "required": [
                        "UserId",
                        "ImageId",
                        "Status"
                    ],
                    "type": "object",
                    "$schema": "http://json-schema.org/draft-04/schema#"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/Models/UpdateUserResponse/Resource"
            }
        },
        "UserPortalGatewayModelsAuthenticateUserResponse955C723F": {
            "Type": "AWS::ApiGateway::Model",
            "Properties": {
                "RestApiId": {
                    "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                },
                "ContentType": "application/json",
                "Description": "Output from the Authentication operation.",
                "Name": "AuthenticateUserResponse",
                "Schema": {
                    "description": "The response from a auth user flow.",
                    "properties": {
                        "UserId": {
                            "description": "Primary identifier for the user.",
                            "type": "string"
                        },
                        "Status": {
                            "description": "Outcome of the Authenticate operation.",
                            "type": "boolean"
                        }
                    },
                    "required": [
                        "UserId",
                        "Status"
                    ],
                    "type": "object",
                    "$schema": "http://json-schema.org/draft-04/schema#"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/Models/AuthenticateUserResponse/Resource"
            }
        },
        "UserPortalGatewayRole348935C3": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "apigateway.amazonaws.com"
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "ManagedPolicyArns": [
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AWSStepFunctionsFullAccess"
                            ]
                        ]
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/Role/Resource"
            }
        },
        "UserPortalGatewayEndpointAddressA9B0266A": {
            "Type": "AWS::SSM::Parameter",
            "Properties": {
                "Type": "String",
                "Value": {
                    "Fn::Join": [
                        "",
                        [
                            "https://",
                            {
                                "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                            },
                            ".execute-api.",
                            {
                                "Ref": "AWS::Region"
                            },
                            ".",
                            {
                                "Ref": "AWS::URLSuffix"
                            },
                            "/",
                            {
                                "Ref": "UserPortalGatewayUserPortalDeploymentStageprod784D2EBD"
                            },
                            "/"
                        ]
                    ]
                },
                "Name": "/riv/Riv-Prod/userportal/url"
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/Gateway/EndpointAddress/Resource"
            }
        },
        "UserPortalStatesRegisterLogGroup0CEA68C4": {
            "Type": "AWS::Logs::LogGroup",
            "Properties": {
                "RetentionInDays": 731
            },
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/States/Register/LogGroup/Resource"
            }
        },
        "UserPortalStatesRegisterStateMachineRoleE0C66934": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "states.",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            ".amazonaws.com"
                                        ]
                                    ]
                                }
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/States/Register/StateMachine/Role/Resource"
            }
        },
        "UserPortalStatesRegisterStateMachineRoleDefaultPolicyE95F5992": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "logs:CreateLogDelivery",
                                "logs:GetLogDelivery",
                                "logs:UpdateLogDelivery",
                                "logs:DeleteLogDelivery",
                                "logs:ListLogDeliveries",
                                "logs:PutResourcePolicy",
                                "logs:DescribeResourcePolicies",
                                "logs:DescribeLogGroups"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords",
                                "xray:GetSamplingRules",
                                "xray:GetSamplingTargets"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": "lambda:InvokeFunction",
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsDetectFacesLambdaFunctionC2191E4E",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "UserPortalFunctionsDetectFacesLambdaFunctionC2191E4E",
                                                    "Arn"
                                                ]
                                            },
                                            ":*"
                                        ]
                                    ]
                                }
                            ]
                        },
                        {
                            "Action": "lambda:InvokeFunction",
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsSearchFacesLambdaFunction780C379C",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "UserPortalFunctionsSearchFacesLambdaFunction780C379C",
                                                    "Arn"
                                                ]
                                            },
                                            ":*"
                                        ]
                                    ]
                                }
                            ]
                        },
                        {
                            "Action": "lambda:InvokeFunction",
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsIndexFacesLambdaFunction6555F0B7",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "UserPortalFunctionsIndexFacesLambdaFunction6555F0B7",
                                                    "Arn"
                                                ]
                                            },
                                            ":*"
                                        ]
                                    ]
                                }
                            ]
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "UserPortalStatesRegisterStateMachineRoleDefaultPolicyE95F5992",
                "Roles": [
                    {
                        "Ref": "UserPortalStatesRegisterStateMachineRoleE0C66934"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/States/Register/StateMachine/Role/DefaultPolicy/Resource"
            }
        },
        "UserPortalStatesRegisterStateMachineB7136A77": {
            "Type": "AWS::StepFunctions::StateMachine",
            "Properties": {
                "RoleArn": {
                    "Fn::GetAtt": [
                        "UserPortalStatesRegisterStateMachineRoleE0C66934",
                        "Arn"
                    ]
                },
                "DefinitionString": {
                    "Fn::Join": [
                        "",
                        [
                            "{\"StartAt\":\"Check-ImageQuality\",\"States\":{\"Check-ImageQuality\":{\"Next\":\"Search-ExistingFaces\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"InputPath\":\"$.inputRequest\",\"OutputPath\":\"$\",\"ResultPath\":\"$.detection\",\"Resource\":\"arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
                            {
                                "Fn::GetAtt": [
                                    "UserPortalFunctionsDetectFacesLambdaFunctionC2191E4E",
                                    "Arn"
                                ]
                            },
                            "\",\"Payload.$\":\"$\",\"InvocationType\":\"RequestResponse\"}},\"Search-ExistingFaces\":{\"Next\":\"Check-SearchResults\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"InputPath\":\"$.inputRequest\",\"OutputPath\":\"$\",\"ResultPath\":\"$.search\",\"Resource\":\"arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
                            {
                                "Fn::GetAtt": [
                                    "UserPortalFunctionsSearchFacesLambdaFunction780C379C",
                                    "Arn"
                                ]
                            },
                            "\",\"Payload.$\":\"$\",\"InvocationType\":\"RequestResponse\"}},\"Check-SearchResults\":{\"Type\":\"Choice\",\"Choices\":[{\"Variable\":\"$.search.Payload.TopMatch.Face.ExternalImageId\",\"StringEquals\":\"Special:RIV_NO_FACE_MATCH\",\"Next\":\"Index-FaceInfo\"},{\"Variable\":\"$.search.Payload.TopMatch.Face.IsCallerUser\",\"BooleanEquals\":true,\"Next\":\"Index-FaceInfo\"}],\"Default\":\"UserAlreadyExistsError\"},\"UserAlreadyExistsError\":{\"Type\":\"Fail\",\"Error\":\"UserAlreadyExists\",\"Cause\":\"Cannot register double faces in same collections.\"},\"Index-FaceInfo\":{\"Next\":\"Registration-Complete\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"InputPath\":\"$.inputRequest\",\"OutputPath\":\"$\",\"ResultPath\":\"$.index\",\"Resource\":\"arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
                            {
                                "Fn::GetAtt": [
                                    "UserPortalFunctionsIndexFacesLambdaFunction6555F0B7",
                                    "Arn"
                                ]
                            },
                            "\",\"Payload.$\":\"$\",\"InvocationType\":\"RequestResponse\"}},\"Registration-Complete\":{\"Type\":\"Pass\",\"Parameters\":{\"UserId.$\":\"$.inputRequest.UserId\",\"ImageId.$\":\"$.index.Payload.FaceRecord.Face.ImageId\",\"Status\":\"Registered\"},\"End\":true}},\"TimeoutSeconds\":30}"
                        ]
                    ]
                },
                "LoggingConfiguration": {
                    "Destinations": [
                        {
                            "CloudWatchLogsLogGroup": {
                                "LogGroupArn": {
                                    "Fn::GetAtt": [
                                        "UserPortalStatesRegisterLogGroup0CEA68C4",
                                        "Arn"
                                    ]
                                }
                            }
                        }
                    ],
                    "IncludeExecutionData": true,
                    "Level": "ALL"
                },
                "StateMachineName": "Riv-Prod-UserPortal-Register_User",
                "StateMachineType": "EXPRESS",
                "TracingConfiguration": {
                    "Enabled": true
                }
            },
            "DependsOn": [
                "UserPortalStatesRegisterStateMachineRoleDefaultPolicyE95F5992",
                "UserPortalStatesRegisterStateMachineRoleE0C66934"
            ],
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/States/Register/StateMachine/Resource"
            }
        },
        "UserPortalStatesRegisterIdCardLogGroup476459F4": {
            "Type": "AWS::Logs::LogGroup",
            "Properties": {
                "RetentionInDays": 731
            },
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/States/Register-IdCard/LogGroup/Resource"
            }
        },
        "UserPortalStatesRegisterIdCardStateMachineRole9B336A52": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "states.",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            ".amazonaws.com"
                                        ]
                                    ]
                                }
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/States/Register-IdCard/StateMachine/Role/Resource"
            }
        },
        "UserPortalStatesRegisterIdCardStateMachineRoleDefaultPolicyB3AF50CD": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "logs:CreateLogDelivery",
                                "logs:GetLogDelivery",
                                "logs:UpdateLogDelivery",
                                "logs:DeleteLogDelivery",
                                "logs:ListLogDeliveries",
                                "logs:PutResourcePolicy",
                                "logs:DescribeResourcePolicies",
                                "logs:DescribeLogGroups"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords",
                                "xray:GetSamplingRules",
                                "xray:GetSamplingTargets"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": "lambda:InvokeFunction",
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsDetectFacesLambdaFunctionC2191E4E",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "UserPortalFunctionsDetectFacesLambdaFunctionC2191E4E",
                                                    "Arn"
                                                ]
                                            },
                                            ":*"
                                        ]
                                    ]
                                }
                            ]
                        },
                        {
                            "Action": "lambda:InvokeFunction",
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsSearchFacesLambdaFunction780C379C",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "UserPortalFunctionsSearchFacesLambdaFunction780C379C",
                                                    "Arn"
                                                ]
                                            },
                                            ":*"
                                        ]
                                    ]
                                }
                            ]
                        },
                        {
                            "Action": "lambda:InvokeFunction",
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsCompareFacesWithIDCardLambdaFunction99427197",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "UserPortalFunctionsCompareFacesWithIDCardLambdaFunction99427197",
                                                    "Arn"
                                                ]
                                            },
                                            ":*"
                                        ]
                                    ]
                                }
                            ]
                        },
                        {
                            "Action": "lambda:InvokeFunction",
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsIndexFacesLambdaFunction6555F0B7",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "UserPortalFunctionsIndexFacesLambdaFunction6555F0B7",
                                                    "Arn"
                                                ]
                                            },
                                            ":*"
                                        ]
                                    ]
                                }
                            ]
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "UserPortalStatesRegisterIdCardStateMachineRoleDefaultPolicyB3AF50CD",
                "Roles": [
                    {
                        "Ref": "UserPortalStatesRegisterIdCardStateMachineRole9B336A52"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/States/Register-IdCard/StateMachine/Role/DefaultPolicy/Resource"
            }
        },
        "UserPortalStatesRegisterIdCardStateMachine83835B73": {
            "Type": "AWS::StepFunctions::StateMachine",
            "Properties": {
                "RoleArn": {
                    "Fn::GetAtt": [
                        "UserPortalStatesRegisterIdCardStateMachineRole9B336A52",
                        "Arn"
                    ]
                },
                "DefinitionString": {
                    "Fn::Join": [
                        "",
                        [
                            "{\"StartAt\":\"Check-ImageQuality\",\"States\":{\"Check-ImageQuality\":{\"Next\":\"Search-ExistingFaces\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"InputPath\":\"$.inputRequest\",\"OutputPath\":\"$\",\"ResultPath\":\"$.detection\",\"Resource\":\"arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
                            {
                                "Fn::GetAtt": [
                                    "UserPortalFunctionsDetectFacesLambdaFunctionC2191E4E",
                                    "Arn"
                                ]
                            },
                            "\",\"Payload.$\":\"$\",\"InvocationType\":\"RequestResponse\"}},\"Search-ExistingFaces\":{\"Next\":\"Check-SearchResults\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"InputPath\":\"$.inputRequest\",\"OutputPath\":\"$\",\"ResultPath\":\"$.search\",\"Resource\":\"arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
                            {
                                "Fn::GetAtt": [
                                    "UserPortalFunctionsSearchFacesLambdaFunction780C379C",
                                    "Arn"
                                ]
                            },
                            "\",\"Payload.$\":\"$\",\"InvocationType\":\"RequestResponse\"}},\"Check-SearchResults\":{\"Type\":\"Choice\",\"Choices\":[{\"Or\":[{\"Variable\":\"$.search.Payload.TopMatch.Face.ExternalImageId\",\"StringEquals\":\"Special:RIV_NO_FACE_MATCH\"},{\"Variable\":\"$.search.Payload.TopMatch.Face.IsCallerUser\",\"BooleanEquals\":true}],\"Next\":\"CompareFacesWithIDCard\"}],\"Default\":\"UserAlreadyExistsError\"},\"UserAlreadyExistsError\":{\"Type\":\"Fail\",\"Error\":\"UserAlreadyExists\",\"Cause\":\"Cannot register double faces in same collections.\"},\"CompareFacesWithIDCard\":{\"Next\":\"Check-FaceCompareWithIDCard\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"InputPath\":\"$.inputRequest\",\"OutputPath\":\"$\",\"ResultPath\":\"$.search\",\"Resource\":\"arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
                            {
                                "Fn::GetAtt": [
                                    "UserPortalFunctionsCompareFacesWithIDCardLambdaFunction99427197",
                                    "Arn"
                                ]
                            },
                            "\",\"Payload.$\":\"$\",\"InvocationType\":\"RequestResponse\"}},\"Check-FaceCompareWithIDCard\":{\"Type\":\"Choice\",\"Choices\":[{\"Or\":[{\"Variable\":\"$.search.Payload.IsMatch\",\"BooleanEquals\":true}],\"Next\":\"Index-FaceInfo\"}],\"Default\":\"FaceNotMatchWithIDCardError\"},\"FaceNotMatchWithIDCardError\":{\"Type\":\"Fail\",\"Error\":\"FaceNotMatchWithIDCard\",\"Cause\":\"User face not match with the provided ID Card.\"},\"Index-FaceInfo\":{\"Next\":\"Registration-Complete\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"InputPath\":\"$.inputRequest\",\"OutputPath\":\"$\",\"ResultPath\":\"$.index\",\"Resource\":\"arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
                            {
                                "Fn::GetAtt": [
                                    "UserPortalFunctionsIndexFacesLambdaFunction6555F0B7",
                                    "Arn"
                                ]
                            },
                            "\",\"Payload.$\":\"$\",\"InvocationType\":\"RequestResponse\"}},\"Registration-Complete\":{\"Type\":\"Pass\",\"Parameters\":{\"UserId.$\":\"$.inputRequest.UserId\",\"ImageId.$\":\"$.index.Payload.FaceRecord.Face.ImageId\",\"Status\":\"Registered\"},\"End\":true}},\"TimeoutSeconds\":30}"
                        ]
                    ]
                },
                "LoggingConfiguration": {
                    "Destinations": [
                        {
                            "CloudWatchLogsLogGroup": {
                                "LogGroupArn": {
                                    "Fn::GetAtt": [
                                        "UserPortalStatesRegisterIdCardLogGroup476459F4",
                                        "Arn"
                                    ]
                                }
                            }
                        }
                    ],
                    "IncludeExecutionData": true,
                    "Level": "ALL"
                },
                "StateMachineName": "Riv-Prod-UserPortal-Register_IdCard",
                "StateMachineType": "EXPRESS",
                "TracingConfiguration": {
                    "Enabled": true
                }
            },
            "DependsOn": [
                "UserPortalStatesRegisterIdCardStateMachineRoleDefaultPolicyB3AF50CD",
                "UserPortalStatesRegisterIdCardStateMachineRole9B336A52"
            ],
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/States/Register-IdCard/StateMachine/Resource"
            }
        },
        "UserPortalStatesUpdateLogGroup5970DB72": {
            "Type": "AWS::Logs::LogGroup",
            "Properties": {
                "RetentionInDays": 731
            },
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/States/Update/LogGroup/Resource"
            }
        },
        "UserPortalStatesUpdateStateMachineRoleF786B6C4": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "states.",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            ".amazonaws.com"
                                        ]
                                    ]
                                }
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/States/Update/StateMachine/Role/Resource"
            }
        },
        "UserPortalStatesUpdateStateMachineRoleDefaultPolicy8C502444": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "logs:CreateLogDelivery",
                                "logs:GetLogDelivery",
                                "logs:UpdateLogDelivery",
                                "logs:DeleteLogDelivery",
                                "logs:ListLogDeliveries",
                                "logs:PutResourcePolicy",
                                "logs:DescribeResourcePolicies",
                                "logs:DescribeLogGroups"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords",
                                "xray:GetSamplingRules",
                                "xray:GetSamplingTargets"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": "lambda:InvokeFunction",
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsDetectFacesLambdaFunctionC2191E4E",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "UserPortalFunctionsDetectFacesLambdaFunctionC2191E4E",
                                                    "Arn"
                                                ]
                                            },
                                            ":*"
                                        ]
                                    ]
                                }
                            ]
                        },
                        {
                            "Action": "lambda:InvokeFunction",
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsCompareFacesLambdaFunction0ED2F588",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "UserPortalFunctionsCompareFacesLambdaFunction0ED2F588",
                                                    "Arn"
                                                ]
                                            },
                                            ":*"
                                        ]
                                    ]
                                }
                            ]
                        },
                        {
                            "Action": "lambda:InvokeFunction",
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsSearchFacesLambdaFunction780C379C",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "UserPortalFunctionsSearchFacesLambdaFunction780C379C",
                                                    "Arn"
                                                ]
                                            },
                                            ":*"
                                        ]
                                    ]
                                }
                            ]
                        },
                        {
                            "Action": "lambda:InvokeFunction",
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsIndexFacesLambdaFunction6555F0B7",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "UserPortalFunctionsIndexFacesLambdaFunction6555F0B7",
                                                    "Arn"
                                                ]
                                            },
                                            ":*"
                                        ]
                                    ]
                                }
                            ]
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "UserPortalStatesUpdateStateMachineRoleDefaultPolicy8C502444",
                "Roles": [
                    {
                        "Ref": "UserPortalStatesUpdateStateMachineRoleF786B6C4"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/States/Update/StateMachine/Role/DefaultPolicy/Resource"
            }
        },
        "UserPortalStatesUpdateStateMachineC5A4EA2D": {
            "Type": "AWS::StepFunctions::StateMachine",
            "Properties": {
                "RoleArn": {
                    "Fn::GetAtt": [
                        "UserPortalStatesUpdateStateMachineRoleF786B6C4",
                        "Arn"
                    ]
                },
                "DefinitionString": {
                    "Fn::Join": [
                        "",
                        [
                            "{\"StartAt\":\"Check-ImageQuality\",\"States\":{\"Check-ImageQuality\":{\"Next\":\"Compare-CachedFaces\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"InputPath\":\"$.inputRequest\",\"OutputPath\":\"$\",\"ResultPath\":\"$.detection\",\"Resource\":\"arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
                            {
                                "Fn::GetAtt": [
                                    "UserPortalFunctionsDetectFacesLambdaFunctionC2191E4E",
                                    "Arn"
                                ]
                            },
                            "\",\"Payload.$\":\"$\",\"InvocationType\":\"RequestResponse\"}},\"Compare-CachedFaces\":{\"Next\":\"CompareFaces-IsMatches\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"InputPath\":\"$.inputRequest\",\"OutputPath\":\"$\",\"ResultPath\":\"$.compare\",\"Resource\":\"arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
                            {
                                "Fn::GetAtt": [
                                    "UserPortalFunctionsCompareFacesLambdaFunction0ED2F588",
                                    "Arn"
                                ]
                            },
                            "\",\"Payload.$\":\"$\",\"InvocationType\":\"RequestResponse\"}},\"CompareFaces-IsMatches\":{\"Type\":\"Choice\",\"Choices\":[{\"Variable\":\"$.compare.Payload.IsMatch\",\"BooleanEquals\":true,\"Next\":\"Index-FaceInfo\"}],\"Default\":\"Search-ExistingFaces\"},\"Search-ExistingFaces\":{\"Next\":\"Check-SearchResults\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"InputPath\":\"$.inputRequest\",\"OutputPath\":\"$\",\"ResultPath\":\"$.search\",\"Resource\":\"arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
                            {
                                "Fn::GetAtt": [
                                    "UserPortalFunctionsSearchFacesLambdaFunction780C379C",
                                    "Arn"
                                ]
                            },
                            "\",\"Payload.$\":\"$\",\"InvocationType\":\"RequestResponse\"}},\"Check-SearchResults\":{\"Type\":\"Choice\",\"Choices\":[{\"Variable\":\"$.compare.Payload.TopMatch.IsCallerUser\",\"BooleanEquals\":false,\"Next\":\"InvalidCredentials\"}],\"Default\":\"Index-FaceInfo\"},\"Index-FaceInfo\":{\"Next\":\"Update-Complete\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"InputPath\":\"$.inputRequest\",\"OutputPath\":\"$\",\"ResultPath\":\"$.index\",\"Resource\":\"arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
                            {
                                "Fn::GetAtt": [
                                    "UserPortalFunctionsIndexFacesLambdaFunction6555F0B7",
                                    "Arn"
                                ]
                            },
                            "\",\"Payload.$\":\"$\",\"InvocationType\":\"RequestResponse\"}},\"Update-Complete\":{\"Type\":\"Pass\",\"Parameters\":{\"UserId.$\":\"$.inputRequest.UserId\",\"ImageId.$\":\"$.index.Payload.FaceRecord.Face.ImageId\",\"Status\":\"Updated\"},\"End\":true},\"InvalidCredentials\":{\"Type\":\"Fail\",\"Error\":\"UserAccessDenied\",\"Cause\":\"The wrong person is in the photo.\"}},\"TimeoutSeconds\":30}"
                        ]
                    ]
                },
                "LoggingConfiguration": {
                    "Destinations": [
                        {
                            "CloudWatchLogsLogGroup": {
                                "LogGroupArn": {
                                    "Fn::GetAtt": [
                                        "UserPortalStatesUpdateLogGroup5970DB72",
                                        "Arn"
                                    ]
                                }
                            }
                        }
                    ],
                    "IncludeExecutionData": true,
                    "Level": "ALL"
                },
                "StateMachineName": "Riv-Prod-UserPortal-Update",
                "StateMachineType": "EXPRESS",
                "TracingConfiguration": {
                    "Enabled": true
                }
            },
            "DependsOn": [
                "UserPortalStatesUpdateStateMachineRoleDefaultPolicy8C502444",
                "UserPortalStatesUpdateStateMachineRoleF786B6C4"
            ],
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/States/Update/StateMachine/Resource"
            }
        },
        "UserPortalStatesAuthLogGroupA8210BF9": {
            "Type": "AWS::Logs::LogGroup",
            "Properties": {
                "RetentionInDays": 731
            },
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/States/Auth/LogGroup/Resource"
            }
        },
        "UserPortalStatesAuthStateMachineRoleFF7A818C": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": {
                                    "Fn::Join": [
                                        "",
                                        [
                                            "states.",
                                            {
                                                "Ref": "AWS::Region"
                                            },
                                            ".amazonaws.com"
                                        ]
                                    ]
                                }
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/States/Auth/StateMachine/Role/Resource"
            }
        },
        "UserPortalStatesAuthStateMachineRoleDefaultPolicyDB75CC13": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "logs:CreateLogDelivery",
                                "logs:GetLogDelivery",
                                "logs:UpdateLogDelivery",
                                "logs:DeleteLogDelivery",
                                "logs:ListLogDeliveries",
                                "logs:PutResourcePolicy",
                                "logs:DescribeResourcePolicies",
                                "logs:DescribeLogGroups"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords",
                                "xray:GetSamplingRules",
                                "xray:GetSamplingTargets"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": "lambda:InvokeFunction",
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsDetectFacesLambdaFunctionC2191E4E",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "UserPortalFunctionsDetectFacesLambdaFunctionC2191E4E",
                                                    "Arn"
                                                ]
                                            },
                                            ":*"
                                        ]
                                    ]
                                }
                            ]
                        },
                        {
                            "Action": "lambda:InvokeFunction",
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsCompareFacesLambdaFunction0ED2F588",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "UserPortalFunctionsCompareFacesLambdaFunction0ED2F588",
                                                    "Arn"
                                                ]
                                            },
                                            ":*"
                                        ]
                                    ]
                                }
                            ]
                        },
                        {
                            "Action": "lambda:InvokeFunction",
                            "Effect": "Allow",
                            "Resource": [
                                {
                                    "Fn::GetAtt": [
                                        "UserPortalFunctionsSearchFacesLambdaFunction780C379C",
                                        "Arn"
                                    ]
                                },
                                {
                                    "Fn::Join": [
                                        "",
                                        [
                                            {
                                                "Fn::GetAtt": [
                                                    "UserPortalFunctionsSearchFacesLambdaFunction780C379C",
                                                    "Arn"
                                                ]
                                            },
                                            ":*"
                                        ]
                                    ]
                                }
                            ]
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "UserPortalStatesAuthStateMachineRoleDefaultPolicyDB75CC13",
                "Roles": [
                    {
                        "Ref": "UserPortalStatesAuthStateMachineRoleFF7A818C"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/States/Auth/StateMachine/Role/DefaultPolicy/Resource"
            }
        },
        "UserPortalStatesAuthStateMachine89B3C1FA": {
            "Type": "AWS::StepFunctions::StateMachine",
            "Properties": {
                "RoleArn": {
                    "Fn::GetAtt": [
                        "UserPortalStatesAuthStateMachineRoleFF7A818C",
                        "Arn"
                    ]
                },
                "DefinitionString": {
                    "Fn::Join": [
                        "",
                        [
                            "{\"StartAt\":\"Check-ImageQuality\",\"States\":{\"Check-ImageQuality\":{\"Next\":\"Compare-CachedFaces\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"InputPath\":\"$.inputRequest\",\"OutputPath\":\"$\",\"ResultPath\":\"$.detection\",\"Resource\":\"arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
                            {
                                "Fn::GetAtt": [
                                    "UserPortalFunctionsDetectFacesLambdaFunctionC2191E4E",
                                    "Arn"
                                ]
                            },
                            "\",\"Payload.$\":\"$\",\"InvocationType\":\"RequestResponse\"}},\"Compare-CachedFaces\":{\"Next\":\"CompareFaces-IsMatches\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"InputPath\":\"$.inputRequest\",\"OutputPath\":\"$\",\"ResultPath\":\"$.compare\",\"Resource\":\"arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
                            {
                                "Fn::GetAtt": [
                                    "UserPortalFunctionsCompareFacesLambdaFunction0ED2F588",
                                    "Arn"
                                ]
                            },
                            "\",\"Payload.$\":\"$\",\"InvocationType\":\"RequestResponse\"}},\"CompareFaces-IsMatches\":{\"Type\":\"Choice\",\"Choices\":[{\"Variable\":\"$.compare.Payload.IsMatch\",\"BooleanEquals\":true,\"Next\":\"Auth-Complete\"}],\"Default\":\"Search-ExistingFaces\"},\"Search-ExistingFaces\":{\"Next\":\"Check-SearchResults\",\"Retry\":[{\"ErrorEquals\":[\"Lambda.ServiceException\",\"Lambda.AWSLambdaException\",\"Lambda.SdkClientException\"],\"IntervalSeconds\":2,\"MaxAttempts\":6,\"BackoffRate\":2}],\"Type\":\"Task\",\"InputPath\":\"$.inputRequest\",\"OutputPath\":\"$\",\"ResultPath\":\"$.search\",\"Resource\":\"arn:",
                            {
                                "Ref": "AWS::Partition"
                            },
                            ":states:::lambda:invoke\",\"Parameters\":{\"FunctionName\":\"",
                            {
                                "Fn::GetAtt": [
                                    "UserPortalFunctionsSearchFacesLambdaFunction780C379C",
                                    "Arn"
                                ]
                            },
                            "\",\"Payload.$\":\"$\",\"InvocationType\":\"RequestResponse\"}},\"Check-SearchResults\":{\"Type\":\"Choice\",\"Choices\":[{\"Variable\":\"$.compare.Payload.TopMatch.IsCallerUser\",\"BooleanEquals\":false,\"Next\":\"InvalidCredentials\"}],\"Default\":\"Auth-Complete\"},\"Auth-Complete\":{\"Type\":\"Pass\",\"Parameters\":{\"UserId.$\":\"$.inputRequest.UserId\",\"Status\":\"Verified\"},\"End\":true},\"InvalidCredentials\":{\"Type\":\"Fail\",\"Error\":\"UserAccessDenied\",\"Cause\":\"The wrong person is in the photo.\"}},\"TimeoutSeconds\":30}"
                        ]
                    ]
                },
                "LoggingConfiguration": {
                    "Destinations": [
                        {
                            "CloudWatchLogsLogGroup": {
                                "LogGroupArn": {
                                    "Fn::GetAtt": [
                                        "UserPortalStatesAuthLogGroupA8210BF9",
                                        "Arn"
                                    ]
                                }
                            }
                        }
                    ],
                    "IncludeExecutionData": true,
                    "Level": "ALL"
                },
                "StateMachineName": "Riv-Prod-UserPortal-Auth",
                "StateMachineType": "EXPRESS",
                "TracingConfiguration": {
                    "Enabled": true
                }
            },
            "DependsOn": [
                "UserPortalStatesAuthStateMachineRoleDefaultPolicyDB75CC13",
                "UserPortalStatesAuthStateMachineRoleFF7A818C"
            ],
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/UserPortal/States/Auth/StateMachine/Resource"
            }
        },
        "RekognitionSetupCollection0RekognitionCollection52D63172": {
            "Type": "Custom::AWS",
            "Properties": {
                "ServiceToken": {
                    "Fn::GetAtt": [
                        "AWS679f53fac002430cb0da5b7982bd22872D164C4C",
                        "Arn"
                    ]
                },
                "Create": {
                    "Fn::Join": [
                        "",
                        [
                            "{\"action\":\"createCollection\",\"service\":\"Rekognition\",\"parameters\":{\"CollectionId\":\"",
                            {
                                "Ref": "AWS::StackName"
                            },
                            "-0\"",
                            "},\"physicalResourceId\":{\"id\":\"RekogitionCollection:",
                            {
                                "Ref": "AWS::StackName"
                            },
                            "-0\"}}"
                        ]
                    ]
                },
                "Delete": {
                    "Fn::Join": [
                        "",
                        [
                            "{\"action\":\"deleteCollection\",\"service\":\"Rekognition\",\"parameters\":{\"CollectionId\":\"",
                            {
                                "Ref": "AWS::StackName"
                            },
                            "-0\"",
                            "},\"physicalResourceId\":{\"id\":\"RekogitionCollection:",
                            {
                                "Ref": "AWS::StackName"
                            },
                            "-0\"}}"
                        ]
                    ]
                },
                "InstallLatestAwsSdk": true
            },
            "DependsOn": [
                "RekognitionSetupCollection0RekognitionCollectionCustomResourcePolicyC35EF824"
            ],
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RekognitionSetup/Collection_0/RekognitionCollection/Resource/Default"
            }
        },
        "RekognitionSetupCollection0RekognitionCollectionCustomResourcePolicyC35EF824": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": "rekognition:CreateCollection",
                            "Effect": "Allow",
                            "Resource": "*"
                        },
                        {
                            "Action": "rekognition:DeleteCollection",
                            "Effect": "Allow",
                            "Resource": "*"
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "RekognitionSetupCollection0RekognitionCollectionCustomResourcePolicyC35EF824",
                "Roles": [
                    {
                        "Ref": "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RekognitionSetup/Collection_0/RekognitionCollection/CustomResourcePolicy/Resource"
            }
        },
        "RekognitionSetupPartitionCountParameter4827825C": {
            "Type": "AWS::SSM::Parameter",
            "Properties": {
                "Type": "String",
                "Value": "1",
                "Description": "Generated from /Users/vkachha/Documents/rekognition-identity-verification/infra/rekognition/topology.py",
                "Name": "/riv/Riv-Prod/rekognition/partition-count",
                "Tier": "Standard"
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RekognitionSetup/PartitionCountParameter/Resource"
            }
        },
        "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "lambda.amazonaws.com"
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "ManagedPolicyArns": [
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
                            ]
                        ]
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/AWS679f53fac002430cb0da5b7982bd2287/ServiceRole/Resource"
            }
        },
        "AWS679f53fac002430cb0da5b7982bd22872D164C4C": {
            "Type": "AWS::Lambda::Function",
            "Properties": {
                "Code": {
                    "S3Bucket": "aws-ml-blog",
                    "S3Key": "artifacts/rekognition-identity-verification-solution/a9d3d4d1afa000946b9863b3e7578a5a5ad86d88274b3639938aa2baebf822ce.zip"
                },
                "Role": {
                    "Fn::GetAtt": [
                        "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2",
                        "Arn"
                    ]
                },
                "Handler": "index.handler",
                "Runtime": "nodejs14.x",
                "Timeout": 120
            },
            "DependsOn": [
                "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2"
            ],
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/AWS679f53fac002430cb0da5b7982bd2287/Resource",
                "aws:asset:path": "asset.a9d3d4d1afa000946b9863b3e7578a5a5ad86d88274b3639938aa2baebf822ce",
                "aws:asset:is-bundled": false,
                "aws:asset:property": "Code"
            }
        },
        "RIVCognitoRIVCognito5285E490": {
            "Type": "AWS::Cognito::UserPool",
            "Properties": {
                "AccountRecoverySetting": {
                    "RecoveryMechanisms": [
                        {
                            "Name": "verified_phone_number",
                            "Priority": 1
                        },
                        {
                            "Name": "verified_email",
                            "Priority": 2
                        }
                    ]
                },
                "AdminCreateUserConfig": {
                    "AllowAdminCreateUserOnly": true
                },
                "EmailVerificationMessage": "The verification code to your new account is {####}",
                "EmailVerificationSubject": "Verify your new account",
                "SmsVerificationMessage": "The verification code to your new account is {####}",
                "UserPoolName": "Riv-Prod",
                "VerificationMessageTemplate": {
                    "DefaultEmailOption": "CONFIRM_WITH_CODE",
                    "EmailMessage": "The verification code to your new account is {####}",
                    "EmailSubject": "Verify your new account",
                    "SmsMessage": "The verification code to your new account is {####}"
                }
            },
            "UpdateReplacePolicy": "Retain",
            "DeletionPolicy": "Retain",
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RIVCognito/RIV-Cognito/Resource"
            }
        },
        "RIVCognitoRIVCognitoClient9838B60D": {
            "Type": "AWS::Cognito::UserPoolClient",
            "Properties": {
                "UserPoolId": {
                    "Ref": "RIVCognitoRIVCognito5285E490"
                },
                "AllowedOAuthFlows": [
                    "implicit",
                    "code"
                ],
                "AllowedOAuthFlowsUserPoolClient": true,
                "AllowedOAuthScopes": [
                    "profile",
                    "phone",
                    "email",
                    "openid",
                    "aws.cognito.signin.user.admin"
                ],
                "CallbackURLs": [
                    "https://example.com"
                ],
                "ClientName": "Riv-Prod",
                "SupportedIdentityProviders": [
                    "COGNITO"
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RIVCognito/RIV-Cognito-Client/Resource"
            }
        },
        "RIVCognitoRIVIdentityPoolBA873C3F": {
            "Type": "AWS::Cognito::IdentityPool",
            "Properties": {
                "AllowUnauthenticatedIdentities": true,
                "CognitoIdentityProviders": [
                    {
                        "ClientId": {
                            "Ref": "RIVCognitoRIVCognitoClient9838B60D"
                        },
                        "ProviderName": {
                            "Fn::GetAtt": [
                                "RIVCognitoRIVCognito5285E490",
                                "ProviderName"
                            ]
                        }
                    }
                ],
                "IdentityPoolName": "Riv-Prod"
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RIVCognito/RIV-IdentityPool"
            }
        },
        "RIVCognitoRIVIdentityPoolUnAuthRole7674F50F": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRoleWithWebIdentity",
                            "Condition": {
                                "StringEquals": {
                                    "cognito-identity.amazonaws.com:aud": {
                                        "Ref": "RIVCognitoRIVIdentityPoolBA873C3F"
                                    }
                                },
                                "ForAnyValue:StringLike": {
                                    "cognito-identity.amazonaws.com:amr": "unauthenticated"
                                }
                            },
                            "Effect": "Allow",
                            "Principal": {
                                "Federated": "cognito-identity.amazonaws.com"
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "Description": "role for amplify riv-prod app",
                "ManagedPolicyArns": [
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AmazonRekognitionFullAccess"
                            ]
                        ]
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RIVCognito/RIVIdentityPoolUnAuthRole/Resource"
            }
        },
        "RIVCognitoRIVIdentityPoolRoleAttachment12C0AA93": {
            "Type": "AWS::Cognito::IdentityPoolRoleAttachment",
            "Properties": {
                "IdentityPoolId": {
                    "Ref": "RIVCognitoRIVIdentityPoolBA873C3F"
                },
                "Roles": {
                    "unauthenticated": {
                        "Fn::GetAtt": [
                            "RIVCognitoRIVIdentityPoolUnAuthRole7674F50F",
                            "Arn"
                        ]
                    }
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RIVCognito/RIV-IdentityPool-Role-Attachment"
            }
        },
        "RIVWebAPPRIVWebAppRepo7790C97E": {
            "Type": "AWS::CodeCommit::Repository",
            "Properties": {
                "RepositoryName": "Riv-Prod-Repo",
                "Code": {
                    "S3": {
                        "Bucket": "aws-ml-blog",
                        "Key": "artifacts/rekognition-identity-verification-solution/63f36faa2155f433a14c01bc1711a9aee88ed62e07552273d0b88e07839e1164.zip"
                    }
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RIVWebAPP/RIV-Web-App-Repo/Resource"
            }
        },
        "RIVWebAPPRole1360D8F8": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "amplify.amazonaws.com"
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "Description": "role for amplify riv-prod app",
                "ManagedPolicyArns": [
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AWSCodeArtifactReadOnlyAccess"
                            ]
                        ]
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RIVWebAPP/Role/Resource"
            }
        },
        "RIVWebAPPRoleDefaultPolicyF0163F8E": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": "codecommit:GitPull",
                            "Effect": "Allow",
                            "Resource": {
                                "Fn::GetAtt": [
                                    "RIVWebAPPRIVWebAppRepo7790C97E",
                                    "Arn"
                                ]
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "RIVWebAPPRoleDefaultPolicyF0163F8E",
                "Roles": [
                    {
                        "Ref": "RIVWebAPPRole1360D8F8"
                    }
                ]
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RIVWebAPP/Role/DefaultPolicy/Resource"
            }
        },
        "RIVWebAPPRIVWebApp70A84C14": {
            "Type": "AWS::Amplify::App",
            "Properties": {
                "Name": "Riv-Prod",
                "AutoBranchCreationConfig": {
                    "AutoBranchCreationPatterns": [
                        "main/*",
                        "prod/*"
                    ],
                    "BasicAuthConfig": {
                        "EnableBasicAuth": false
                    },
                    "EnableAutoBranchCreation": true,
                    "EnableAutoBuild": true,
                    "EnablePullRequestPreview": true
                },
                "BasicAuthConfig": {
                    "EnableBasicAuth": false
                },
                "CustomRules": [
                    {
                        "Source": "</^((?!\\.(css|gif|ico|jpg|js|png|txt|svg|woff|ttf)$).)*$/>",
                        "Status": "200",
                        "Target": "/index.html"
                    }
                ],
                "EnvironmentVariables": [
                    {
                        "Name": "REACT_APP_ENV_API_URL",
                        "Value": {
                            "Fn::Join": [
                                "",
                                [
                                    "https://",
                                    {
                                        "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                                    },
                                    ".execute-api.",
                                    {
                                        "Ref": "AWS::Region"
                                    },
                                    ".",
                                    {
                                        "Ref": "AWS::URLSuffix"
                                    },
                                    "/",
                                    {
                                        "Ref": "UserPortalGatewayUserPortalDeploymentStageprod784D2EBD"
                                    },
                                    "/"
                                ]
                            ]
                        }
                    },
                    {
                        "Name": "REACT_APP_IDENTITYPOOL_ID",
                        "Value": {
                            "Ref": "RIVCognitoRIVIdentityPoolBA873C3F"
                        }
                    },
                    {
                        "Name": "REACT_APP_USERPOOL_ID",
                        "Value": {
                            "Ref": "RIVCognitoRIVCognito5285E490"
                        }
                    },
                    {
                        "Name": "REACT_APP_WEBCLIENT_ID",
                        "Value": {
                            "Ref": "RIVCognitoRIVCognitoClient9838B60D"
                        }
                    },
                    {
                        "Name": "REACT_APP_REGION",
                        "Value": {
                            "Ref": "AWS::Region"
                        }
                    }
                ],
                "IAMServiceRole": {
                    "Fn::GetAtt": [
                        "RIVWebAPPRole1360D8F8",
                        "Arn"
                    ]
                },
                "Repository": {
                    "Fn::GetAtt": [
                        "RIVWebAPPRIVWebAppRepo7790C97E",
                        "CloneUrlHttp"
                    ]
                }
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RIVWebAPP/RIV-Web-App/Resource"
            }
        },
        "RIVWebAPPRIVWebAppmainE864ED78": {
            "Type": "AWS::Amplify::Branch",
            "Properties": {
                "AppId": {
                    "Fn::GetAtt": [
                        "RIVWebAPPRIVWebApp70A84C14",
                        "AppId"
                    ]
                },
                "BranchName": "main",
                "EnableAutoBuild": true,
                "EnablePullRequestPreview": true
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RIVWebAPP/RIV-Web-App/main/Resource"
            }
        },
        "RIVWebAPPTriggerRIVWebAppTriggerBuildDAEECE53": {
            "Type": "Custom::AWS",
            "Properties": {
                "ServiceToken": {
                    "Fn::GetAtt": [
                        "AWS679f53fac002430cb0da5b7982bd22872D164C4C",
                        "Arn"
                    ]
                },
                "Create": {
                    "Fn::Join": [
                        "",
                        [
                            "{\"action\":\"startJob\",\"service\":\"Amplify\",\"parameters\":{\"appId\":\"",
                            {
                                "Fn::GetAtt": [
                                    "RIVWebAPPRIVWebApp70A84C14",
                                    "AppId"
                                ]
                            },
                            "\",\"branchName\":\"main\",\"jobType\":\"RELEASE\",\"jobReason\":\"Auto Start build\"},\"physicalResourceId\":{\"id\":\"app-build-trigger\"}}"
                        ]
                    ]
                },
                "InstallLatestAwsSdk": true
            },
            "DependsOn": [
                "RIVWebAPPRIVWebAppRepo7790C97E",
                "RIVWebAPPRIVWebAppmainE864ED78",
                "RIVWebAPPRIVWebApp70A84C14",
                "RIVWebAPPRoleDefaultPolicyF0163F8E",
                "RIVWebAPPRole1360D8F8",
                "RIVWebAPPTriggerRIVWebAppTriggerBuildCustomResourcePolicy5FEE58F3"
            ],
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RIVWebAPPTrigger/RIV-Web-App-Trigger-Build/Resource/Default"
            }
        },
        "RIVWebAPPTriggerRIVWebAppTriggerBuildCustomResourcePolicy5FEE58F3": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": "amplify:StartJob",
                            "Effect": "Allow",
                            "Resource": "*"
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "RIVWebAPPTriggerRIVWebAppTriggerBuildCustomResourcePolicy5FEE58F3",
                "Roles": [
                    {
                        "Ref": "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2"
                    }
                ]
            },
            "DependsOn": [
                "RIVWebAPPRIVWebAppRepo7790C97E",
                "RIVWebAPPRIVWebAppmainE864ED78",
                "RIVWebAPPRIVWebApp70A84C14",
                "RIVWebAPPRoleDefaultPolicyF0163F8E",
                "RIVWebAPPRole1360D8F8"
            ],
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RIVWebAPPTrigger/RIV-Web-App-Trigger-Build/CustomResourcePolicy/Resource"
            }
        },
        "RIVWebAPPStatusRIVWebAppLambdaServiceRole76A26BCD": {
            "Type": "AWS::IAM::Role",
            "Properties": {
                "AssumeRolePolicyDocument": {
                    "Statement": [
                        {
                            "Action": "sts:AssumeRole",
                            "Effect": "Allow",
                            "Principal": {
                                "Service": "lambda.amazonaws.com"
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "ManagedPolicyArns": [
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AWSCloudFormationFullAccess"
                            ]
                        ]
                    },
                    {
                        "Fn::Join": [
                            "",
                            [
                                "arn:",
                                {
                                    "Ref": "AWS::Partition"
                                },
                                ":iam::aws:policy/AdministratorAccess-Amplify"
                            ]
                        ]
                    }
                ]
            },
            "DependsOn": [
                "RIVWebAPPTriggerRIVWebAppTriggerBuildCustomResourcePolicy5FEE58F3",
                "RIVWebAPPTriggerRIVWebAppTriggerBuildDAEECE53"
            ],
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RIVWebAPPStatus/RIV-Web-App-Lambda/ServiceRole/Resource"
            }
        },
        "RIVWebAPPStatusRIVWebAppLambdaServiceRoleDefaultPolicy14666126": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": [
                                "xray:PutTraceSegments",
                                "xray:PutTelemetryRecords"
                            ],
                            "Effect": "Allow",
                            "Resource": "*"
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "RIVWebAPPStatusRIVWebAppLambdaServiceRoleDefaultPolicy14666126",
                "Roles": [
                    {
                        "Ref": "RIVWebAPPStatusRIVWebAppLambdaServiceRole76A26BCD"
                    }
                ]
            },
            "DependsOn": [
                "RIVWebAPPTriggerRIVWebAppTriggerBuildCustomResourcePolicy5FEE58F3",
                "RIVWebAPPTriggerRIVWebAppTriggerBuildDAEECE53"
            ],
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RIVWebAPPStatus/RIV-Web-App-Lambda/ServiceRole/DefaultPolicy/Resource"
            }
        },
        "RIVWebAPPStatusRIVWebAppLambda32B2270A": {
            "Type": "AWS::Lambda::Function",
            "Properties": {
                "Code": {
                    "ZipFile": "import json\nimport logging\nimport boto3\nfrom botocore.exceptions import ClientError\n\nclient = boto3.client('amplify')\n\n\ndef lambda_handler(event, context):\n    # apps = client.list_apps()\n    appName, appId = getApp(event['app'])\n    if (appName is not None):\n        branch = getBranch(appId, event['branch'])\n        if (branch is not None):\n            # client.create_backend_environment(\n            #     appId=appId,\n            #     environmentName='main',\n            #     stackName='Riv-Prod-Backend',\n            #     deploymentArtifacts='Riv-Prod'\n            # )\n            i = False\n            jobId = getJob(appId, branch)\n            if (jobId is not None):\n                while (i == False):\n                    job_status = client.get_job(\n                        appId=appId,\n                        branchName=branch,\n                        jobId=jobId\n                    )\n                    status = job_status['job']['summary']['status']\n                    if (status == 'FAILED' or status == 'SUCCEED' or status == 'CANCELLED'):\n                        i = True\n                        break\n    return {\n        \"status\": \"Amplify App deployed Successfully.\"\n    }\n\n\ndef getApp(name):\n    apps = client.list_apps()\n    appName = None\n    appId = None\n    for sub in apps['apps']:\n        if sub['name'] == name:\n            appName = sub['name']\n            appId = sub['appId']\n            # deleteAPP = client.delete_app(\n            #     appId=sub['appId']\n            # )\n            break\n    return appName, appId\n\n\ndef getBranch(appId, name):\n    response = client.list_branches(appId=appId)\n    branchName = None\n    for sub in response['branches']:\n        if sub['branchName'] == name:\n            branchName = sub['branchName']\n            break\n    return branchName\n\n\ndef getJob(appId, branch):\n    jobs = client.list_jobs(\n        appId=appId,\n        branchName=branch,\n    )\n    jobId = None\n    for sub in jobs['jobSummaries']:\n        status = sub['status']\n        if (status == 'PENDING' or status == 'PROVISIONING' or status == 'RUNNING' or status == 'CANCELLING'):\n            jobId = sub['jobId']\n            break\n    return jobId\n"
                },
                "Role": {
                    "Fn::GetAtt": [
                        "RIVWebAPPStatusRIVWebAppLambdaServiceRole76A26BCD",
                        "Arn"
                    ]
                },
                "FunctionName": "Riv-Prod-webapp-deployment",
                "Handler": "index.lambda_handler",
                "Runtime": "python3.9",
                "Timeout": 600,
                "TracingConfig": {
                    "Mode": "Active"
                }
            },
            "DependsOn": [
                "RIVWebAPPStatusRIVWebAppLambdaServiceRoleDefaultPolicy14666126",
                "RIVWebAPPStatusRIVWebAppLambdaServiceRole76A26BCD",
                "RIVWebAPPTriggerRIVWebAppTriggerBuildCustomResourcePolicy5FEE58F3",
                "RIVWebAPPTriggerRIVWebAppTriggerBuildDAEECE53"
            ],
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RIVWebAPPStatus/RIV-Web-App-Lambda/Resource"
            }
        },
        "RIVWebAPPStatusRIVWebAppDeployStatusDCE68B20": {
            "Type": "Custom::AWS",
            "Properties": {
                "ServiceToken": {
                    "Fn::GetAtt": [
                        "AWS679f53fac002430cb0da5b7982bd22872D164C4C",
                        "Arn"
                    ]
                },
                "Create": {
                    "Fn::Join": [
                        "",
                        [
                            "{\"action\":\"invoke\",\"service\":\"Lambda\",\"parameters\":{\"FunctionName\":\"",
                            {
                                "Ref": "RIVWebAPPStatusRIVWebAppLambda32B2270A"
                            },
                            "\",\"InvocationType\":\"RequestResponse\",\"Payload\":\"{\\\"app\\\":\\\"Riv-Prod\\\",\\\"branch\\\":\\\"main\\\"}\"},\"physicalResourceId\":{\"id\":\"Riv-Prod-webapp-stack\"}}"
                        ]
                    ]
                },
                "Update": {
                    "Fn::Join": [
                        "",
                        [
                            "{\"action\":\"invoke\",\"service\":\"Lambda\",\"parameters\":{\"FunctionName\":\"",
                            {
                                "Ref": "RIVWebAPPStatusRIVWebAppLambda32B2270A"
                            },
                            "\",\"InvocationType\":\"RequestResponse\",\"Payload\":\"{\\\"app\\\":\\\"Riv-Prod\\\",\\\"branch\\\":\\\"main\\\"}\"},\"physicalResourceId\":{\"id\":\"Riv-Prod-webapp-stack\"}}"
                        ]
                    ]
                },
                "InstallLatestAwsSdk": true
            },
            "DependsOn": [
                "RIVWebAPPStatusRIVWebAppDeployStatusCustomResourcePolicyD077C86F",
                "RIVWebAPPTriggerRIVWebAppTriggerBuildCustomResourcePolicy5FEE58F3",
                "RIVWebAPPTriggerRIVWebAppTriggerBuildDAEECE53"
            ],
            "UpdateReplacePolicy": "Delete",
            "DeletionPolicy": "Delete",
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RIVWebAPPStatus/RIV-Web-App-Deploy-Status/Resource/Default"
            }
        },
        "RIVWebAPPStatusRIVWebAppDeployStatusCustomResourcePolicyD077C86F": {
            "Type": "AWS::IAM::Policy",
            "Properties": {
                "PolicyDocument": {
                    "Statement": [
                        {
                            "Action": "lambda:InvokeFunction",
                            "Effect": "Allow",
                            "Resource": {
                                "Fn::GetAtt": [
                                    "RIVWebAPPStatusRIVWebAppLambda32B2270A",
                                    "Arn"
                                ]
                            }
                        }
                    ],
                    "Version": "2012-10-17"
                },
                "PolicyName": "RIVWebAPPStatusRIVWebAppDeployStatusCustomResourcePolicyD077C86F",
                "Roles": [
                    {
                        "Ref": "AWS679f53fac002430cb0da5b7982bd2287ServiceRoleC1EA0FF2"
                    }
                ]
            },
            "DependsOn": [
                "RIVWebAPPTriggerRIVWebAppTriggerBuildCustomResourcePolicy5FEE58F3",
                "RIVWebAPPTriggerRIVWebAppTriggerBuildDAEECE53"
            ],
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/RIVWebAPPStatus/RIV-Web-App-Deploy-Status/CustomResourcePolicy/Resource"
            }
        },
        "CDKMetadata": {
            "Type": "AWS::CDK::Metadata",
            "Properties": {
                "Analytics": "v2:deflate64:H4sIAAAAAAAA/2VT0W7bMAz8lrwrarNiGPa2JEOLAglmtNteA0ZmbNWSaEjyAsPwv0+SZafrnnhHifHxTvnEv3zmw2YFV7cWZbNW8syHVw+iYaF1GsregKYyNH/CWSHbX0wCI3MPfNh1okEfmxlNZQcuXJCg+fBC01CqBSkp+kgnNDIF+lwCHx47I7wkE88WfIAe7W+0Lh985AVaLV1ir9JUCj0tw1HfCZxD7/g2FgatrMDjFfqgCp3ftjIJu8GtENQZz75jq6jXaNJm71jwpUrbTCCMUmcFxnUXkn9zwkf0NZWxldGRSlSJRxBEOh3ttkF+ARY0erRptZkEi6hyfDhQ9WSpa5MPGYdxj+0lb+xOHlzj+CFZ+mz+UIP/XuDDviYZZD2CVKwI7sSNPB5B1NLMiy18ZIIqIz3x4ZdDWxAl5QuewV7JbNX/necyAOn7efg9j09i68NTq6O58WslCtJa+hhQSy582vaTnzMbGehWyUvIMAbWJj92Foyox/GWQUo8hhR8jTd+dL7tPBOd86RPNl8LL+Pq9ql3S+8DvYU5ss0aVFsDv199y3+Xu1izonw4RFGLoqIPsZu7B/6Vb+5Xb07KtQ1PTGrkL1P9C4Rx1cKBAwAA"
            },
            "Metadata": {
                "aws:cdk:path": "Riv-Prod/CDKMetadata/Default"
            }
        }
    },
    "Outputs": {
        "UserPortalGatewayUserPortalEndpoint": {
            "Value": {
                "Fn::Join": [
                    "",
                    [
                        "https://",
                        {
                            "Ref": "UserPortalGatewayUserPortal1E4ECB13"
                        },
                        ".execute-api.",
                        {
                            "Ref": "AWS::Region"
                        },
                        ".",
                        {
                            "Ref": "AWS::URLSuffix"
                        },
                        "/",
                        {
                            "Ref": "UserPortalGatewayUserPortalDeploymentStageprod784D2EBD"
                        },
                        "/"
                    ]
                ]
            },
            "Description": "RIV-API-Gateway-URL"
        
        },
        "RIVWebAPPStatusRIVWebAppURL": {
            "Value": {
                "Fn::Join": [
                    "",
                    [
                        "https://main.",
                        {
                            "Fn::GetAtt": [
                                "RIVWebAPPRIVWebApp70A84C14",
                                "AppId"
                            ]
                        },
                        ".amplifyapp.com"
                    ]
                ]
            },
            "Description": "RIV-Web-App-URL"
        },
        "RIVIdentityPoolID": {
            "Value": {
                "Ref": "RIVCognitoRIVIdentityPoolBA873C3F"
            },
            "Description": "Identity Pool ID"
        },
        "RIVCognitoUserPool": {
            "Value": {
                "Ref": "RIVCognitoRIVCognito5285E490"
            },
            "Description": "Cognito User pool id"
        },
        "RIVCognitoClientID": {
            "Value": {
                "Ref": "RIVCognitoRIVCognitoClient9838B60D"
            },
            "Description": "Cognito Client ID"
        },
        "RIVREGION": {
            "Value":  {
                "Ref": "AWS::Region"
            },
            "Description": "AWS REGION"
        }
    }
}